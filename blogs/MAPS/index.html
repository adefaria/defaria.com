<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Movable Type 5.2.3" />
<link rel="stylesheet" href="http://defaria.com/blogs/MAPS/styles.css" type="text/css" />
<link rel="start" href="http://defaria.com/blogs/MAPS/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="http://defaria.com/blogs/MAPS/atom.xml" />
<script type="text/javascript" src="http://defaria.com/blogs/MAPS/mt.js"></script>


    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://defaria.com/blogs/MAPS/rsd.xml" />
    <title>MAPS</title>
</head>
<body id="classic-blog" class="mt-main-index layout-wtt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">


            <h1 id="header-name"><a href="http://defaria.com/blogs/MAPS/" accesskey="1">MAPS</a></h1>
            <h2 id="header-description"></h2>

        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">

                            
                            <div id="entry-651" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2007/07/hit-count-and-l.html" rel="bookmark">Hit Count and Last Hit</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2007-07-13T17:26:08-06:00">July 13, 2007  5:26 PM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>After having left MAPS pretty much alone for a long time, though I did implement "nuke" which helps nuke whole domains, I finally have implemented new functionality for MAPS. You see over this last year or so I've been getting a lot of spam mostly oriented in which the domain name was wildly varying. So lots of mail loops were happening. Whacking whole domains became a favorite past time of mine and hence the "nuke" script (not an official part of MAPS mind you). Still it seemed like a losing battle.</p>

<p>Then I got to thinking - something I've been thinking for a while - how effective are all of my null list entries, now numbering in the 17K area! I thought that I could easily add some fields to the list table, namely a hit_count and a last_hit field, and then during scrubbing time see if these null list entries were at all effective, and if not then to automatically remove them.</p>

<p>So I added the fields and changed MAPS such that it records the hits and when the last hit happened. Then in mapsscrub check to see if last_hit is older than the number of days the user is keeping history. If it's 0 then simply remove that entry. Note this happens only for the null list. White list and black list are to be managed by the user. You purposely add somebody to the white or black list for a reason. Do we want to auto age these off? Probably not.</p>

<p>If the hit count is not 0 then how do we age off these apparently no longer effective null list entries? Well the though was to age them by subtracting 1 from the hit count. Thus if we had a null list entry that was fairly active for a little while and say accumulated a hit_count of 10 but then was largely un-hit, the hit_count would go 9, 8, 7, 6, 5... down to 0 and then the entry would be removed. I might want to change this as some null list entries are getting hit_counts in the thousands now! Assuming the user has a 30 day history then perhaps after 30 days of inactivity I should age any null list entry off the list in 7 days? Note that any activity in those 30 days would immediately reset the clock for at least the next 30 days (assuming a history of 30 days).</p>

<p>With this in place I decided to change the mail loop procedure to auto add the sender to the null list. Previously I was whacking off the whole domain - here we are just auto adding the individual sending address. But it's automatically added, automatically tracked for effectiveness and automatically aged off. Beside I still have the option of perusing the top returning domains and can whack whole domains still. Now any hits on any users in the domain will continue to insure that that domain null list entry will remain and not automatically age away...</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-542" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2006/04/no-more-defaria.html" rel="bookmark">No more &lt;anything&gt;@defaria.com</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2006-04-15T22:58:40-06:00">April 15, 2006 10:58 PM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Due to an influx of spam getting through MAPS with a format of &lt;something&gt;@defaria.com I finally decided to fix MAPS to handle that better. Now if the from is from defaria.com (or the current domain) then the user name is looked up in /etc/passwd using getpwent and if there is no user of that name it is simply nulllisted. This is an obvious attempt by spammers to forge from email addresses.</p>

<p>Also removed logging of when the message is obviously garbled or not conforming to standards. Plus I no longer log if the user uses andrew@defaria.com but fails to have a name such as "Andrew DeFaria &lt;andrew@defaria.com&gt;". The former turns out to be mostly Nigerian spam anyway.</p>

<p>FInally, replaced /usr/local/amps with a direct checkout form CVS!</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-469" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2005/11/maps-scrubber.html" rel="bookmark">MAPS Scrubber</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2005-11-06T10:17:58-06:00">November  6, 2005 10:17 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Updated mapsscrub to also report total number of user emails in the database. Also fixed header.</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-468" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2005/11/added-page-drop.html" rel="bookmark">Added page drop down</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2005-11-05T10:44:37-06:00">November  5, 2005 10:44 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Added a page drop down to list.php. This is useful when one wants to say <i>go to the last page</i>.</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-150" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2004/03/move-list-entry.html" rel="bookmark">Move list entry bug</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2004-03-08T09:17:23-06:00">March  8, 2004  9:17 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Found a bug today. While adding to the blacklist an entry was on the white list, MAPS correctly adds the entry to the black list and deletes the entry on the white list. However it fails to resequence the white list causing problems down the line.</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-139" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2004/02/login-bug.html" rel="bookmark">Login bug</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2004-02-17T23:25:05-06:00">February 17, 2004 11:25 PM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Squashed a nasty bug, well actually a lack of implementation. After converting some of the web pages to PHP I neglected to implement Login in PHP! Now implemented.</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-138" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="http://defaria.com/blogs/MAPS/archives/2004/02/space.html" rel="bookmark">Space</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2004-02-16T23:12:26-06:00">February 16, 2004 11:12 PM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Added new "Space Usage" report. Not sure if I like this because 1) it's too slow and 2) the resulting report is not very impressive - it's just a line saying "User is using X bytes in the databsase". Might wish to implement a space counter in the user table. This would require that all procedures updating the database update the space counter. The intent for this space counter is to judge how much space a user is using in the database for the purposes of quotas or perhaps to charge people if they want more space.</p>

<p>Also, currently this space report is only counting space used in the email table. Might wish to add in the log table, which can add up, and the user and useropts tables. The latter two are minimal but including them would make the report more accurate.</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="http://defaria.com/blogs/MAPS/archives.html">Archives</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-archive widget-archive-category widget">
    <h3 class="widget-header">Categories</h3>
    <div class="widget-content">
    
    </div>
</div>




    <div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="http://defaria.com/blogs/MAPS/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2005/11/">November 2005 (2)</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2004/03/">March 2004 (1)</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2004/02/">February 2004 (3)</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2003/11/">November 2003 (3)</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2003/10/">October 2003 (9)</a></li>
        
        </ul>
    </div>
</div>
        
    



<div class="widget-pages widget">
    <h3 class="widget-header">Pages</h3>
    <div class="widget-content">
        <ul>
    
    
        </ul>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="http://defaria.com/mt/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="http://defaria.com/blogs/MAPS/atom.xml">Subscribe to this blog's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="http://defaria.com/mt/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.2.3" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>



    
<div id="gamma">
    <div id="gamma-inner">
    <div class="widget-search widget">
    <h3 class="widget-header">Search</h3>
    <div class="widget-content">
        <form method="get" action="http://defaria.com/mt/mt-search.cgi">
            <input type="text" id="search" class="ti" name="search" value="" />

            <input type="hidden" name="IncludeBlogs" value="3" />

            <input type="hidden" name="limit" value="20" />
            <input type="submit" accesskey="4" value="Search" />
        </form>
    </div>
</div>

<div class="widget-recent-entries widget-archives widget">
    <h3 class="widget-header">Recent Entries</h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2007/07/hit-count-and-l.html">Hit Count and Last Hit</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2006/04/no-more-defaria.html">No more &lt;anything&gt;@defaria.com</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2005/11/maps-scrubber.html">MAPS Scrubber</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2005/11/added-page-drop.html">Added page drop down</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2004/03/move-list-entry.html">Move list entry bug</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2004/02/login-bug.html">Login bug</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2004/02/space.html">Space</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2004/02/delete-bug.html">Delete bug</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2003/11/rounded-tables.html">Rounded Tables</a></li>
        
    
        
            <li><a href="http://defaria.com/blogs/MAPS/archives/2003/11/css-site.html">CSS Site</a></li>
        
        </ul>
    </div>
</div>
        
    


    
    


    </div>
</div>




                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.org/">Movable Type</a>
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
