<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml" />

   <title>Status for Andrew DeFaria: Code complete for cmconfig.vbs</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/000246.html" title="Env var problems" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/000247.html" title="Populate users" />

   

   

   <script type="text/javascript" src="http://defaria.com/blogs/Status/mt-site.js"></script>
</head>
<body class="layout-one-column" onload="individualArchivesOnLoad(commenter_name)">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">

                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/000246.html">&laquo; Env var problems</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/000247.html">Populate users &raquo;</a>
                     </p>

                     <a id="a000245"></a>
                     <div class="entry" id="entry-245">
                        <h3 class="entry-header">Code complete for cmconfig.vbs</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>Working mainly on cmconfig.vbs. Solution for the env problem was to set both the user environment and the process environment then call cmverfiy.cmd from cmconfig.vbs. The code now does the folowing:</p>

<ol>
  <li>Configure Clearquest using installutil</li>

  <li>Verify connection to Clearquest</li>

  <li>Connect to the TOOLS database and verify that the user exists there</li>

  <li>Verify the user is in the proper Clearcase Active Directory group</li>

  <li>Set CLEARCASE_PRIMARY_GROUP and CLEARCASE_GROUPS properly for the user based on the users TOOLS record</li>

  <li>Set the Clearcase region as per the user's TOOLS record</li>

  <li>Configure user's Clearquest email settings</li>

  <li>Add registry entry to execute PMO-CM.cmd</li>

  <li>Add registry entry indicating the version of this script that was used</li>

  <li>Update the following fields in the user's record in the TOOLS database:

  <ul>
     <li>machineName (set to hostname if machineName was blank or set to "My Computer" or "Unknown")</li>

    <li>machineName2 (set to hostname if machineName was NOT blank or set to "My Computer" or "Unknown")</li>

    <li>idAddedtoCC (if #4 succeeds)</li>

    <li>isDeployed (if no other errors occur)</li>

    <li>isAddedtoCQ (if #3 succeeds)</li>
  </ul>

  <li>Runs cmverify to verify that all is OK</li>
</ul>
                           </div>
                           <div id="more" class="entry-more">
                              
                           </div>
                        </div>
                        <p class="entry-footer">
                           <span class="post-footers">Posted by  on September 14, 2004  6:01 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000245.html">Permalink</a>
                        </p>
                     </div>

                     

                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
