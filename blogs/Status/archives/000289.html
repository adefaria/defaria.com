<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml" />

   <title>Status for Andrew DeFaria: cvs_report.pl</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/000288.html" title="Built 012405" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/000290.html" title="CVS corruption" />

   

   

   <script type="text/javascript" src="http://defaria.com/blogs/Status/mt-site.js"></script>
</head>
<body class="layout-one-column" onload="individualArchivesOnLoad(commenter_name)">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">

                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/000288.html">&laquo; Built 012405</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/000290.html">CVS corruption &raquo;</a>
                     </p>

                     <a id="a000289"></a>
                     <div class="entry" id="entry-289">
                        <h3 class="entry-header">cvs_report.pl</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>I've updated cvs_report.pl to be more parameterized and flexible. One goal was to make it smart enough to produce a report showing the ECRs between two labels. This is helpful when one wants to get the ECRs that were picked up in this build.</p>

                           </div>
                           <div id="more" class="entry-more">
                              <p>Here's the usage:</p>

<div class="code"><pre>
$ cvs_report.pl -u
Usage: cvs_report.pl [-u] [-email-to &lt;<i>list</i>&gt;] [-email-cc &lt;<i>list</i>&gt;]
                     -from &lt;<i>tag</i>&gt; -to &lt;<i>tag</i>&gt; -m &lt;<i>cvs_module</i>&gt;

Where:

        -u:             Display usage
        -email-to:      Comma separated list of email addresses
                        to send the report to (Default: Report sent to STDOUT)
        -email-cc:      Comma separated list of email addresses
                        to cc the report to
        -from:          CVS tag used as the base (Default: Extracted from CVS
                        area - error if no CVS area)
        -to:            CVS tag used as the delta (Default: HEAD)
        -m:             CVS module to process
</pre></div>

<p>Notice that there are options for -email-to and -email-cc. If no email options are specified then cvs_report just outputs the report to STDOUT. This can be used to capture what was picked up. For example, to pickup the ECRs that were incorporated between Lion_lynxos_120604 and Lion_lynxos_012405 one could:</p>

<div class="code"><pre>
$ cvs_report.pl -from Lion_lynxos_120405 -to Lion_lynxos_012405 -m lynxos > /tmp/ECRs.log
</pre></div>

<p>Note that if -to is not specified then it defaults to HEAD. So the following cronjob could be configured:</p>

<div class="code"><pre>
* 4 * * * /it/bin/cvs_report.pl -email-to &lt;<i>email alias</i>&gt;
</pre></div>

<p>(It would be best if email aliases were used to control who the report is normally sent to).</p>

<p>You may notice that there is no -from in the cronjob. This is possible because of another optimization change to cvs_report.  The old cvs_report.pl would check out a module into a temporary directory based on a tag then do an update capturing and processing the output from cvs update as the files that have changed. Then it would remove that temporary area. This is a waste as the next night the CVS area is created again from the same -from or base tag. The new cvs_report will also create the temporary area by using $module.cvsr (e.g. lynxos.cvsr). Additionally it will create a file in $module.cvsr named .cvsr containing the -from tag. Subsequent runs of cvs_report without a -from will use the .cvsr file to ascertain what base level the CVS area is at. Thus it does not need to "refresh" the CVS area again and can instead proceed to the cvs update step. This saves several minutes of processing time.</p>

<p>Finally, even the cronjob does not need to ever be changed (except if we change the -email-to parameter, which, again, should be an email alias thus we would not change the cronjob rather we would change the email alias - think of people subscribing to receive the CVS report). When we go from Lion_lynxos_012405 -> the next tag all that need be done in a shell window is:</p>

<div class="code"><pre>
$ cvs_report.pl -from &lt;<i>new tag</i>&gt; -m lynxos
</pre></div>

<p>Since -from is specified, cvs_report will refresh the lynxos.cvs area and update the .cvsr file to reflect the change. The nightly cronjob will automatically sense the change and just work!</p>

<p>Oh, and in passing, I make a change such that new files, files who were not present at the -from tag, are tagged with an "*" to indicate that this file is new file in CVS.</p>

                           </div>
                        </div>
                        <p class="entry-footer">
                           <span class="post-footers">Posted by  on January 27, 2005  4:11 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000289.html">Permalink</a>
                        </p>
                     </div>

                     

                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
