<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml" />

   <title>Status for Andrew DeFaria: Triggers</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/000426.html" title="PQA Code Page/SJ Vob move" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/000430.html" title="Clearquest Franchise/PQA Invalid ASCII characters" />

   

   

   <script type="text/javascript" src="http://defaria.com/blogs/Status/mt-site.js"></script>
</head>
<body class="layout-one-column" onload="individualArchivesOnLoad(commenter_name)">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">

                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/000426.html">&laquo; PQA Code Page/SJ Vob move</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/000430.html">Clearquest Franchise/PQA Invalid ASCII characters &raquo;</a>
                     </p>

                     <a id="a000427"></a>
                     <div class="entry" id="entry-427">
                        <h3 class="entry-header">Triggers</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Worked on mktriggers script to mktriggers for all regions, all vobs</li>
</ul>
                           </div>
                           <div id="more" class="entry-more">
                              <h2>Trigger Standardization</h2>

<p>I have been trying to centralize and standardize triggers. The idea here is to be able to add all the triggers to all of the necessary vobs quickly and easily and to insure that triggers - implementors of policy - are consistently applied. As triggers are not replicated by Multisite it is essential that you can add triggers to a replicate if needed. For example, we need it to add triggers to the new replicas of the San Jose and Irvine vobs. Also new triggers and new vobs come into being and you usually want to make sure that all vobs have the appropriate triggers in force.</p>

<blockquote><strong>Note:</strong> For example, the vob /vobs/CommEngine is replicated from Irvine <-> San Jose. Irvine has a set of triggers applied to their replica and we have a different set.
</blockquote>

<p>Within Broadcom there are various vobs in various regions. This makes automation a little more difficult but not impossible. Some standardization of what triggers go where and how Clearcase gains access to the trigger code is necessary. One way I've seen companies accomplish this in the past was to create an administration vob and place trigger code in that vob. This vob would be replicated to all sites and trigger code made available through the use of a snapshot view in a well known location. Other administrative scripts can be shared in a similar fashion. Additionally we need to address differences between Windows and Unix.</p>

<h2>Inconsistent paths</h2>

<p>As it stands now triggers seem to be in a few places and I don't think that this places are kept in sync. As such I see inconsistencies that are confusing me. For example there are the following paths to triggers mentioned in /home/vobadm/scripts/mktrtype.sh:</p>

<div class="code"><pre>
       ccase-atla-1)
          NTPATH="\\\cc-atla-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-blr-1)
          NTPATH="\\\cc-blr-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-brsa-1)
          NTPATH="\\\cc-brsa-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-irva-2)
          NTPATH="\\\Fs-irva-37\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-irva-4)
          NTPATH="\\\Fs-irva-37\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-irva-tst)
          NTPATH="\\\Fs-irva-37\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-mhtb-1)
          NTPATH="\\\cc-mhtb-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-peka-1)
          NTPATH="\\\cc-peka-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-rmna-3)
          NTPATH="\\\cc-rmna-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-sdoa-1|ccase-sdoa-2)
          NTPATH="\\\Fs-irva-37\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;

       ccase-sj1-1)
          NTPATH="\\\cc-sj-storage\ccase\bse\script\trigger"
          UNIXPATH="/projects/ccase/bse/script/trigger"
          ;;

       ccase-tlva-1|ccase-tlva-1.il.broadcom.com)
          NTPATH="\\\cc-tlva-storage\ccase\script\trigger"
          UNIXPATH="/projects/ccase/script/trigger"
          ;;
</pre></div>

<p>As you can see the NTPATH varies where the UNIXPATH is largely the same (ccase-sj1-1 puts scripts under bse). Also, with ccase-rmna-3 it says /projects/ccase/script/trigger yet is currently using /projects/cc4/triggers and the differences between those two directories are many. Which one is correct? Why the bse directory for San Jose?</p>

<p>I assume that the reasons for the different NTPATH names is to avoid going over the WAN to get trigger script code. I also assume that this is mitigated on Unix by use of the automounter and yet we cannot say that UNIXPATH is always the same due to the difference in San Jose. I wonder if DFS could be used to provide a consistent, globally well known path to trigger code under Windows...</p>

<p>In any event the question that rises is how are these various repositories of code kept in sync if at all?</p>

<h2>Inconsistent Application of Triggers</h2>

<p>Normally there are a certain set of triggers that are implementing policy that are consistently applied to all vobs (or at least all vobs in a region). For example, usually empty branches are considered bad and to be avoided. Thus there is normally a trigger script applied to all vobs to avoid this. Or if an organization determines that rmelem should not be performed then it is enforced with a trigger on all vobs. Yet there doesn't seem to be any triggers consistently applied to all vobs. In fact many vobs have no triggers at all!</p>

<p>I see, for example, 3 different triggers for preop checkins: GIpreci, preci and test_preci. Triggers could be written that can be applied to any vob and then they act only if the conditions are such that they should do something. IOW for situations where they don't apply they simple exit.</p>

<p>There are also triggers that do nothing but allow people to proceed or not based on whether the user is on an "approved" list. They carry with them a long list of -nusers. I would think that that would be more difficult to maintain than for a trigger to be written that opens up a file of approved users and validates the user based on that. Then to add/change/delete users one merely needs to update the data file, not re-create a trigger in a vob and then have to worry about what other vobs need their triggers updated. Of course the trigger would need to deal with the issue of what is the global file pathname to that data file.</p>
                           </div>
                        </div>
                        <p class="entry-footer">
                           <span class="post-footers">Posted by  on September 25, 2005 11:04 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000427.html">Permalink</a>
                        </p>
                     </div>

                     

                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
