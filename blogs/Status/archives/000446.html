<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml" />

   <title>Status for Andrew DeFaria: PQA Clearquest</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/000445.html" title="SJ VOB Move" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/000447.html" title="PQA Clearquest" />

   

   

   <script type="text/javascript" src="http://defaria.com/blogs/Status/mt-site.js"></script>
</head>
<body class="layout-one-column" onload="individualArchivesOnLoad(commenter_name)">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">

                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/000445.html">&laquo; SJ VOB Move</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/000447.html">PQA Clearquest &raquo;</a>
                     </p>

                     <a id="a000446"></a>
                     <div class="entry" id="entry-446">
                        <h3 class="entry-header">PQA Clearquest</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Hooked up new PQA schema database and data database</li>

  <li>Starting to code merge routines</li>

  <li>Created PQA Schedule (See below)</li>
</ul>
                           </div>
                           <div id="more" class="entry-more">
                              <h3>Moving MS/SQL Databases</h3>

<p>Moving a MS/SQL Database from one host to another involves a bit of tweaking to get the new system to recognize that it has a new database. I will attempt to detail here what needs to be done. </p>

<p>In order to import Clearquest databases to a new MS SQL Database Server:</p>

<ol>
  <li>Place imported datafile onto new machine.</li>

  <li>Start the MS SQL Server Enterprise Manager (C:\Windows\system32\mmc.exe /s "C:\Program Files\Microsoft SQL Server\80\Tools\BINN\SQL Server Enterprise Manager.msc")</li>

  <li>Expand tree until you see "(local)" then "Databases". Right click on Database and select New Database to create an empty new database. Name the database appropriately. On the Data Files tab we changed the default path of C:\Program Files\Microsoft SQL Server\MSSQL\data\&lt;database name&gt;.mdf to a more approriate place. Also check the Transaction Log tab to adust path.</li>

  <li>Restore database by right clicked on the new database you created and selecting All Tasks: Restore Database. Under Restore select From Device then click Add then find the restored db file. Under Options change the paths for Move to physical file name.</li>

  <li>For Clearquest Schema databases only (You may need to restart the SQL Server Enterprise Manager after the above restore of the database): Since Clearquest uses a database to hold the schema and that schema points to known user databases, importing a Clearquest schema will have entries that point over to <b>projection</b> databases! These need to change:

    <ul>
      <li>In SQL Sever Enterprise Manager locate your imported schema database and double click on Tables.</li>

      <li>Find master_dbs, right click on master_dbs and select Open Table: Return All Rows.</li>

      <li>Change the server column to the name of the new server</li>

      <li>Select Run (the ! symbol in the toolbar)</li>
    </ul>

  <li>Folllow instructions at <a href="http://support.microsoft.com/default.aspx?scid=kb;%5bLN%5d;Q240872">How to resolve permission issues when you move a database between servers that are running SQL Server</a> for fixing permissions problems.</li>

  <li>Import user databases. Note the fix above regarding master_dbs:server is <b>not</b> required for user databases</li>
</ol>

<h3>Merge Routines and Connecting to Multiple Schemas</h3>

<p>With two schema databases I was having problems with my Perl script connecting to the databases. In the past I had:

<div class="code"><pre>
      ## Internal variables ##
      my $session;
      my $login           = "admin";
      my $password    = "*****";
      my $masterdb    = ""; # Don't need a masterdb (Using default?)
      my $db_name;
    ...
      sub StartSession {
        $db_name = shift;

        $session = CQPerlExt::CQSession_Build ();

        $session->UserLogon ($login, $password, $db_name, $masterdb);
      } # StartSession
</pre></div>

<p>Now when I run this in the presence of two schema databases I get:</p>

<div class=box>
    The database "MASTR" belonging to master database "2002.05.00" is an invalid name. Enter the correct name of a ClearQuest user database. at c:/Program Files/Rational/ClearQuest/lib/CQPerlExt.pm line 3713.
</div>

<p>I think I need to specify the proper $ masterdb name but I don't know what that might be... Hmmm... Seems that $masterdb is really just the Connection name that you'd see when you start Clearquest Designer or Clearquest Client and there are multiple schemas to choose from. That's odd because that could be potentially anything as the user could rename it. However if I use PQA_Old on p4test (which is what I named the old schema connection) then it works.</p>

<p>OK, more work on this tomorrow. I have already defined the new defect record in my Perl module. I just have to start coding the merge routines now...</p>

<h3>PQA Schedule</h3>

<p>The following is a rough estimate of the work needed to be completed to get to the point where we are ready to convert the live production databases</p>

<ul>
  <li> Restore new Schema DB and Data DB (<font color="#999">1 Day</font>)</li>

  <li> Investigate record/field mappings (<font color="#999">2 Days</font>)</li>

  <li>Determine order fo record additions (<font color="#999">1 Day</font>)</li>

  <li>Investigate requirements for adding of records to Clearquest (<font color="#999">2 Days</font>)</li>

  <li>Code/Test merge procedures (<font color="#999">3 Day</font>)</li>

  <li>Test conversion on <b>p4test</b> (<font color="#999">4 Days</font>)</li>
</ul>

<p><b>Total:</b> 13 Days</p>
                           </div>
                        </div>
                        <p class="entry-footer">
                           <span class="post-footers">Posted by  on October 10, 2005 12:11 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000446.html">Permalink</a>
                        </p>
                     </div>

                     

                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
