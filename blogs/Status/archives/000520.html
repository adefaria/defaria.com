<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml" />

   <title>Status for Andrew DeFaria: CQ Web Email Problem</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/000519.html" title="Mobile Multimedia Clearquest Design" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/000521.html" title="More CQ Web Email Problems (GetSMTPHost)" />

   

   

   <script type="text/javascript" src="http://defaria.com/blogs/Status/mt-site.js"></script>
</head>
<body class="layout-one-column" onload="individualArchivesOnLoad(commenter_name)">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">

                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/000519.html">&laquo; Mobile Multimedia Clearquest Design</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/000521.html">More CQ Web Email Problems (GetSMTPHost) &raquo;</a>
                     </p>

                     <a id="a000520"></a>
                     <div class="entry" id="entry-520">
                        <h3 class="entry-header">CQ Web Email Problem</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Worked on problem with CQ Web sending email</li>
</ul>
                           </div>
                           <div id="more" class="entry-more">
                              <h2>CQ Web Email Problem when in the DMZ</h2>

<p>OK, here's what's going on. As you know we were having a problem with the email being sent out with a date of 2001. I looked into this the best I could but could not figure out what was causing this. I don't claim to be an expert on VB or VB objects like the PAINET object that was being used to send email. I looked on the web for clues and saw somebody saying that they switched to using the CDO object for sending email as it was better. I also remembered that I had done some VBS at Ameriquest and I had sent email from those scripts. When I looked at it I saw that I too was using the CDO object.</p>

<p>Next I tried replacing the usage of the PAINET object to send email with the CDO object and the send date problem seemed to have corrected itself.</p>

<p>Now it's not working in one very specific and unfortunately one very critical place - nbu-cqweb!</p>

<p>Another thing I could not figure out with the PAINET object is that it never seemed to specify an SMTP server to use to send the email. It just did it somehow. (Turns out it actually uses the client's settings and is exactly the reason why the user must set these!) The CDO object, however, needs to have an SMTP server specified so I used one I thought was guaranteed to be available - smtphost.broadcom.com. This works... while in Broadcom but it does not work when in the DMZ and nbu_cqweb is in the DMZ.</p>

<p>I see two options at this point:</p>

<ol>
  <li>Revert back to the old PAINET object and live with the send date of 2001 until we can figure out why that's happening (Considering that it's now known that it's the clients settings as to which SMTP server is used, it's quite possible that one user may generate email with a send date in the year 2001 while another user wouldn't) or</li>

  <li>Figure out an SMTP host in the DMZ and implement code to use it when in the DMZ or use smtphost.broadcom.com when not in the DMZ.</li>
</ol>

<p>For the second approach the problem is that I need to dynamically use mms.broadcom.com while in the DMZ and smtphost.broadcom.com when not in the DMZ. How does one tell? I thought I could simply check the hostname or domainname but I don't see any easy ways of getting this information in VB. Does anybody else?</p>

                           </div>
                        </div>
                        <p class="entry-footer">
                           <span class="post-footers">Posted by  on January 20, 2006  7:57 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000520.html">Permalink</a>
                        </p>
                     </div>

                     

                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
