<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml"$>" />

   <title>Status for Andrew DeFaria: March 2005 Archives</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/2005_02.html" title="February 2005" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/2005_04.html" title="April 2005" />
</head>
<body class="layout-one-column">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">
                     
                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/2005_02.html">&laquo; February 2005</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/2005_04.html">April 2005 &raquo;</a>
                     </p>
                     
                     
                     

                     <h2 class="date-header">March 31, 2005</h2>
                     <a id="a000327"></a>
                     <div class="entry" id="entry-327">
                        <h3 class="entry-header">Finalized HybridOS</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Finished up CR 1 for HybridOS checkin - assigned to Thu for review</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:10 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000327.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 30, 2005</h2>
                     <a id="a000326"></a>
                     <div class="entry" id="entry-326">
                        <h3 class="entry-header">HybridOS Binary Comparison problems</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Managed to perform binary comparison of HybridOS</li>
</ul>
                              
                              <h3>HybridOS Binary Comparison</h3>

<p>HybridOS has been checked in and built. As you know the binary comparison procedure described in the GS: LOS178 Impact Summary discovered more differences. Specifically 227 .o files had differences. Further investigation revealed that the action of committing the sources to CVS caused $Header/ident strings to change. The following describes the changes to the $Header strings due to cvs commit:</p>

<div class="code"><pre>
tomcat:strings -a orig.uipc_usrreq.o | grep Header
$Header: /cvs/<font color="blue"><b>los178-cvs</b></font>/los178/sys/networking/tcpip/general/uipc_usrreq.c,v  <font color="orange"><b>1.1.1.1</b></font> <font color="green"><b>2004/03/03 00:59:24</b></font> <font color="purple"><b>emooring</b></font> Exp $
tomcat:strings -a new.uipc_usrreq.o | grep Header
$Header: /cvs/<font color="blue"><b>hybrid-os-cvs</b></font>/los178/sys/networking/tcpip/general/uipc_usrreq.c,v <font color="orange"><b>1.1</b></font> <font color="green"><b>2005/03/30 00:39:03</b></font> <font color="purple"><b>adefaria</b></font> Exp $
</pre></div>

<p>The changes are as follows:</p>

<ol>
  <li>CVS Repository name changed from los178-cvs -> hybrid-os-cvs (<font color="blue">blue</font>)</li>

  <li>Revision changed from whatever it was -> 1.1 (<font color="orange">orange</font>) All revisions for HybridOS are now 1.1</li>

  <li>Date changed to reflect time of cvs commit to new CVS repository (<font color="green">green</font>)</li>

  <li>User changed from whatever it was -> adefaria (<font color="purple">purple</font>) since I was the user to perform the commit</li>
</ol>

<p>Using objdump once again to disassemble these .o files and comparing the output left us with the following .o files that were still different:</p>

<ol>
  <li>/sys/lib/libcsp_970.a (context_asm.o)</li>

  <li>/sys/lib/libcsp_970.a (csp_cpu_asm.o)</li>

  <li>/sys/lib/libcsp_970.a (flih.o)</li>

  <li>/sys/lib/libcsp_970.a (fpu_asm.o)</li>

  <li>/sys/lib/libcsp_970.a (launch_asm.o)</li>

  <li>/sys/lib/libcsp_970.a (tlbmiss.o)</li>
</ol>

<p>Closer examination of these .o files reveals that the also contained ident strings in the text segment that had the same differences as the $Header differences described above. In other words the code was the same but the version strings and dates changed, as is expected.</p>

                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:59 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000326.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 29, 2005</h2>
                     <a id="a000325"></a>
                     <div class="entry" id="entry-325">
                        <h3 class="entry-header">Hybrid OS</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Checked HybridOS into CVS</li>

  <li>Rebuilt HybridOS</li>

  <li>Attempted binary comparison - fails due to $Header$ strings</li>
</ul>
                              
                              <h3>Binary Differences</h3>

<p>Well the build finished but the binary comparison as per the Impact Summary failed. For a while I thought I did something wrong so I went back and re-extracted from the SCL and rebuild the old LOS178 that I had stored on the side, etc. Still it kept failing! Not only 25 files that were different and needed to be disassembled and compared but more like 228 files! What's going on?!?</p>

<p>So I dug deeper... Seems that $Header is embedded in some .o files and the $Headers differ (picking at random a .o that didn't compare):</p>

<div class="code"><pre>
tomcat:strings -a new.uipc_usrreq.o | grep Header
$Header: /cvs/hybrid-os-cvs/los178/sys/networking/tcpip/general/uipc_usrreq.c,v 1.1 2005/03/30 00:39:03 adefaria Exp $
tomcat:strings -a orig.uipc_usrreq.o | grep Header
$Header: /cvs/los178-cvs/los178/sys/networking/tcpip/general/uipc_usrreq.c,v 1.1.1.1 2004/03/03 00:59:24 emooring Exp $
tomcat:
</pre></div>

<p>So as you can see, we have differences. I don't know why all 2543 .o files extracted from the .a files didn't all differ.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 11:08 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000325.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 28, 2005</h2>
                     <a id="a000324"></a>
                     <div class="entry" id="entry-324">
                        <h3 class="entry-header">HybridOS built</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Built Hybrid OS for GD and performed binary comparison</li>

  <li>Adding files to CVS on Tomcat</li>

  <li>Completed GD LOS178 Impact Summary</li>

  <li>Resolved long standing issue regarding gnuaout vs. gnu</li>
</ul>
                              
                              <h2>GD LOS178 Impact Summary</h2>

<h3>Export sources from LOS178</h3>

<p>Export sources from LOS178 CVS tree using the CVS tag REL_LOS178_2p0p0_ppc_FCS. The export will come from the machine named Rock using CVSROOT=:pserver:anoncvs@rock:/cvs/los178-cvs:</p>

<div class="code"><pre>
tomcat:export CVSROOT=:pserver:anoncvs@rock:/cvs/los178-cvs
tomcat:cvs login
Logging in to :pserver:anoncvs@rock:2401/cvs/los178-cvs
CVS password:
tomcat:cvs export -r REL_LOS178_2p0p0_ppc_FCS los178
</pre></div>

<h3>Extract prebuilt CDK</h3>

<p>Extract prebuilt CDK (sunos-xcoff-ppc) binary also using the tag of REL_LOS178_2p0p0_ppc_FCS from Rock. Note that this prebuilt CDK comes from the bin-image section of the CVS repository and that we are only using the ppc.cdksol.tar.gz image:</p>

<div class="code"><pre>
tomcat:cvs export -r REL_LOS178_2p0p0_ppc_FCS bin-image/ppc.cdksol.tar.gz
</pre></div>

<h3>Extract other tools</h3>

<p>The package.sh script from the toolbox area is used to package up the images so we need to extract that too:</p>

<div class="code"><pre>
tomcat:cvs export -r REL_LOS178_2p0p0_ppc_FCS toolbox/package.sh
</pre></div>

<h3>Test Build</h3>

<p>Perform test build.</p>

<div class="note">
Note: Test build requires a symlink from /usr/lynx/3.1.0/ppc/cdk/sunos-xcoff-ppc/bin/bison.simple -> $ENV_PREFIX/cdk/sunos-xcoff-ppc-/bin/bison-simple due to a hard coded path dependency.  This path was not modified due to LOS-178 RSC restrictions
</div>

<p>Steps performed are:</p>

<ol>
  <li>Create ppc_dev area to perform the build in:<br>

<div class="code"><pre>
tomcat:mkdir ppc_dev
</pre></div></li>

  <li>Copy in sources:<br>

<div class="code"><pre>
tomcat:rsync -a los178 ppc_dev
</pre></div></li>

  <li>Unpack CDK into build area<br>

<div class="code"><pre>
tomcat:cd ppc_dev
tomcat:gnutar -zxpf ../bin-image/ppc.cdksol.tar.gz
</pre></div></li>

  <li>Perform build:<br>

<div class="code"><pre>
tomcat:make DEVELOPMENT=yes install > install.log
</pre></div></li>

  <li>Check install.log for errors</li>
</ol>

<h3>Perform binary comparison test</h3>

<p>This binary comparison test is different from the normal binary comparison tests. Basically we are simply extracting all .o's from all .a's in the packaged versions of the product. A little utility script was written to find all .a libraries and copy them to an area (complibs) broken out by the path to the library, then extract all .o's from the .a's. This script is called unpack_libs. It is not intended that such a comparison be performed on a regular basis so this script is more of a one shot script.</p>

<p>Further, a build will create a lot of libraries but not all libraries created will be packaged and shipped. Since we are comparing against a previously built and packaged release we must package up and unpack the build we just performed. This is done using the toolbox/package.sh script as follows:</p>

<ol>
  <li>Package up the image just built:<br>

<div class="code"><pre>
tomcat:toolbox/package.sh ppc_dev dev
</pre></div></li>

    <li>Unpack images to new area:<br>

<div class="code"><pre>
tomcat:mkdir new
tomcat:cd new
tomcat:for tarfile in ../media/*.tar.gz; do
> gnutar -zxpf $tarfile
> done
</pre></div></li>

  <li>Gather all libraries and extract their .o's:<br>

<div class="code"><pre>
tomcat:mkdir complibs
tomcat:../unpack_libs
</pre></div></li>

  <li>Unpack old images (from  t3:/export/scl/los178/2p0p0/FCS/) to old area:<br>

<div class="code"><pre>
tomcat:cd ..
tomcat:mkdir old
tomcat:cd old
tomcat:# copy old tar images here
tomcat:for tarfile in *.tar.gz; do
> gnutar -zxpf $tarfile
> done
</pre></div></li>

  <li>Gather all libraries and extract their .o's:<br>

<div class="code"><pre>
tomcat:mkdir complibs
tomcat:../unpack_libs
</pre></div></li>

  <li>Perform diff<br>

<div class="code"><pre>
tomcat:cd ..
tomcat:diff -r old/complibs new/complibs
</pre></div></li>

  <li>The above will result in 25 .o files being different. Use objdump -D to disassemble these files and compare the disassembled output. No differences detected in disassembled output.</li>
</ol>

<h3>Import sources into new CVS repository</h3>

<p>Sources  will be  imported into the CVS repository using the following command:</p>

<div class="code"><pre>
tomcat:cd los178
tomcat:export CVSROOT=:pserver:adefaria@tomcat:/cvs/hybrid-os-cvs
tomcat:cvs login
Logging in to :pserver:adefaria@tomcat:2401/cvs/hybrid-os-cvs
CVS password:
tomcat:# First add all directories
tomcat:find . ! -name CVS -type d -exec cvs add -m "HybridOS import from LOS178" {} \;
tomcat:# Now add all files
tomcat:find . -type f -exec cvs add -m "HybridOS import from LOS178" {} \;
tomcat:cvs commit
</pre></div>

<p>Additionally the binary CDK image was checked into binary-image:</p>

<div class="code"><pre>
tomcat:cd ../bin-image
tomcat:cvs add -m "HybridOS import from LOS178" ppc.cdksol.tar.gz
tomcat:cvs commit
</pre></div>

<p>Finally the toolbox/package.sh script as checked into toolbox:</p>

<div class="code"><pre>
tomcat:cd ../toolbox
tomcat:cvs add -m "HybridOS import from LOS178" package.sh
tomcat:cvs commit
</pre></div>

<h3>Tag initial sources with the tag REL_HYBRIDOS_1p0_ppc_20050328</h3>

<p>All sources, bin packages and toolbox scripts are then tagged:</p>

<div class="code"><pre>
tomcat:cvs tag REL_HYBRIDOS_1p0_ppc_20050328 los178 bin-image toolbox
</pre></div>

<h3>Check out all sources and prebuilt CDK and perform build procedure again</h3>

<p>Next we check out all sources, bin-image and toolbox scripts into new fresh areas and then perform the build procedure as described above.</p>

<h3>Following successful build perform binary comparison test again</h3>

<p>Perform the binary comparison described above again.</p>

<h3>Package build to archive area</h3>

<p>Use the package script to package up the images and place in the archive area at tomcat:/export/dev_archive/hybridos/1p0/20050328/solaris/media/ppc</p>

<h2>Long standing issue regarding gnuaout vs. gnu</h2>

<p>This has been bugging me for a while and I finally tracked it down. Often I'd build a toolchain then attempt to build LynxOS and it would fail when attempting to get the compiler. It seems that the toolchain build was packing up the compiler tar image with one name and the build scripts were using another name to try to find it. This resulted in errors. Now I had gotten around this via a symlink but I've been wanting to make the two build procedures agree on the names of things...</p>

<p>As Adam writes here the preferred name for the toolchain tar image is derived from config.guess:</p>

<blockquote type=cite>
<p>Andrew DeFaria writes:</p>

  <blockquote type=cite>
  <p>toolchain-i686-pc-linux-gnu-i386.tar.gz</p>
  </blockquote>

<p>This. But I think we get this from config.guess so try to see how this nice level of abstraction fails before you hard-code something.</p>
</blockquote>

<p>The "toolchain-" portion is standard for the toolchain. The "i686-pc-linux-gnu" portion comes out of config.guess:</p>

<div class="code"><pre>
[int@dopey 20050207]$ /export/build1/LYNXOS_500/work_area/toolchain/3.2.2/toolchain/src/config.guess
    i686-pc-linux-gnu
</pre></div>

<p>However the int_tools uses the following code to determine the name of the toolchain tar image:</p>

<div class="code"><pre>
proc Unload_com { platform dir comp_release format host } {

  switch "$host" {
    <font color="red"><b>"linux"  { set host_platform "i686-pc-linux-<u>gnuaout</u>" }</b></font>
    "win32"  { set host_platform "i686-pc-cygwin" }
    "sunos"  { set host_platform "sparc-sun-solaris2.7" }
    "lynxos" { if { "$platform" == "x86" } {
                   set host_platform "i386-lynx-lynxos"
               }
               if { "$platform" == "ppc" } {
                     set host_platform "powerpc-lynx-lynxos"
               }
             }
  }
  if { "$platform" == "x86" } {
        set target_platform "i386"
  } else {
        set target_platform "$platform"
  }
  set COMPILER_TAR_GZ "toolchain-$host_platform-$target_platform.tar.gz"
</pre></div>

<p>The highlighted portion above is the line in error and the underlined portion should change to simply "gnu". The int_tools do not have the benefit of being able to call config.guess so this could likely break in the future again.</p>

<p>I will perform this change, along with other int_tool changes required for the new tag labeling under and ECR.</p>

                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:30 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000324.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 25, 2005</h2>
                     <a id="a000323"></a>
                     <div class="entry" id="entry-323">
                        <h3 class="entry-header">LOS178 compares</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>LOS178 does finally compare. Apparently .o files produced by assembly must be compared at the source level by using objdump to dump assembly</li>

  <li>Attempting build of LOS178 on Tomcat before putting GD LOS178 into CVS.</li>

  <li>Hit problem with hard coded paths - need Jeff to resolve these</li>
</ul>
                              
                              <h3>Comparing Assembled .o files</h3>

<p>25 files did not compare. Turns out these were probably generated by the assembler. Instead we use objdump which comes in in the CDK. This eliminates differences that may be due to date/timestamps.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  9:37 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000323.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 23, 2005</h2>
                     <a id="a000321"></a>
                     <div class="entry" id="entry-321">
                        <h3 class="entry-header">LOS178 build</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Building LOS178 Development version to compare to previously release images</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:34 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000321.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 22, 2005</h2>
                     <a id="a000322"></a>
                     <div class="entry" id="entry-322">
                        <h3 class="entry-header">Bluecat build still failing</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Bluecat build still fails with same problem. Emailed Sasha</li>

  <li>Native PPC Toolchain still failing - same problems</li>

  <li>Recreated cvsr.php - file was previously deleted</li>
</ul>
                              
                              <h3>Bluecat build failing</h3>

<p>Alexander Sanochkin wrote:</p>

<blockquote>
<p>Andrew,</p>

<p>It seems you tried to use a build tag which was not ready to rebuild BlueCat at that time. Also please note that the main BC build script has changed due to updating the BC cross compiler to version 3.4.3. The script is called do_it-bc5.0-gcc_3.4.3. You can get it from the BlueCat CVS. (/cm/CVS/BlueCat/eng/int/scripts).</p>

<p>Regarding the glib build problem we can not provide intelligent comments at this time as it seems that the 20050314 environment
is not available for us on the jaguar machine.</p>
</blockquote>

<p>What build tag are we supposed to use? I found R_5_2_1_ppc_20050319 and I assume that is what I should use. However the difference between do_it-bc5.0-gcc_3.4.3 and do_it-bc5.0 is merely:</p>

<div class="code"><pre>
[int@jaguar loc_archive]$ diff do_it-bc5.0.orig do_it-bc5.0-gcc_3.4.3.orig
108c108
<   export BC_TARGET=$BLUECAT_TARGET_CPU-lynx-linux-bluecat
---
>   export BC_TARGET=$BLUECAT_TARGET_CPU-lynx-linux-gnubc
</pre></div>

<p>And, if I might ask, why all the version numbers in the file? Why isn't it just named do_it and depending on which CVS (RCS?) tag you use you get a 5.0 or a 5.0-gcc_3.4.3 version?</p>

<p>Also, with do_it-bg5.0-gcc_3.4.3 I suspect that the changes I made for the patch-spec (changing do_step to perform patches between steps 1 and 2 when run in stepwise fashion) have not be incorporated. Seems to me that there are two steps being done in automated mode (i.e. doing all steps at one time) that are not performed when doing things in a stepwise fashion. The first is the building of the new GNU Tools which is effectively step 0 and the second is this patching thing which is normally done between steps 1 and 2. Might I suggest that we make these regular steps in their proper order and renumber the rest?</p>

<p>Build is still failing (on Jaguar). I get to step4 and it fails with:</p>

<div class="code"><pre>
Building glib package step 4.3 at 22:51:22
parse_file: build_package failed for glib_trg.spec
---- Step 4 finished successfully at Tue Mar 22 14:51:39 PST 2005 ----

Looking at step4/build_glib.log I see:

[int@jaguar step4]$ tail -f build_glib.log
+ ac_cv_func_getpwuid_r=yes
+ ac_cv_func_mutex_trylock=yes
+ ac_cv_func_cond_timedwait=yes
+ glib_cv_sizeof_gmutex=24
+ glib_cv_byte_contents_gmutex=0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
+ ./configure --build=i386-linux-gnu --host=ppc-bluecat-linux
configure: warning: Could not determine POSIX flag. (-posix didn't work.)
configure: error: can not run test program while cross compiling
error: Bad exit status from /usr/lynx/loc_archive/build/20050319/var/tmp/rpm-tmp.40621 (%build)
    Bad exit status from /usr/lynx/loc_archive/build/20050319/var/tmp/rpm-tmp.40621 (%build)
</pre></div>

<p>Attempting to execute rpm-tmp.40621 reveals:</p>

<div class="code"><pre>
gcc -g -O2 -Wall -D_REENTRANT -o testglib testglib.o .libs/libglib.a
.libs/libglib.a(gmessages.o): In function `g_logv':
/usr/lynx/loc_archive/build/20050319/cdt/src/bluecat/BUILD/glib-1.2.10/gmessages.c:343: undefined reference to `va_copy'
.libs/libglib.a(gstrfuncs.o): In function `g_strdup_vprintf':
    /usr/lynx/loc_archive/build/20050319/cdt/src/bluecat/BUILD/glib-1.2.10/gstrfuncs.c:154: undefined reference to `va_copy'
collect2: ld returned 1 exit status
make[2]: *** [testglib] Error 1
make[2]: Leaving directory `/usr/lynx/loc_archive/build/20050319/cdt/src/bluecat/BUILD/glib-1.2.10'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/usr/lynx/loc_archive/build/20050319/cdt/src/bluecat/BUILD/glib-1.2.10'
make: *** [all-recursive-am] Error 2
+ exit 0
</pre></div>

<p>Any ideas?</p>

<h3>Native PPC Toolchain failure</h3>

<p>Build of the Native PPC Toolchain keeps failing for me but not for Oleg. Oleg's been suggesting that I lower the ulimits to -s 100000 and -d 200000, which I did but which fails for me and not Oleg. Oleg writes:</p>

<blockquote>
<p>Perhaps the time of the day has some effect on the file system behaviour (or an increased local network activity during the business time has some adverse effect on the system stability). Please try to start the toolchain build at your end-of-business time.</p>

<p>Meanwhile, we will ponder on what else can be wrong.</p>
</blockquote>

                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:44 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000322.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 18, 2005</h2>
                     <a id="a000318"></a>
                     <div class="entry" id="entry-318">
                        <h3 class="entry-header">NetSNMP/Native x86 toolchain problems/ECR Linkify</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Change NetSNMP package to automatically handle installation of snmpd-sample.conf file</li>

  <li>Native toolchain build still failing despite assistance from Moscow</li>

  <li>Made ECR Linkify better</li>
                              
                              <h3>NetSNMP</h3>

<p>Changed install_snmp.sh to install snmpd-sample.conf into /usr/local/share/snmp/snmpd.conf for both the bin and src packages. In the bin package we put a copy of snmpd-sample.conf into tmp.</p>

<p>Still need to figure out how/where to check this into the RCS tree.</p>

<p>Build scripts do not do this automatically but the build scripts have other issues.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:34 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000318.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 17, 2005</h2>
                     <a id="a000319"></a>
                     <div class="entry" id="entry-319">
                        <h3 class="entry-header">Bluecat Build</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Bluecat build's step 4 failed again</li>

  <li>Attempting to reproduce build with old tag</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:35 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000319.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 16, 2005</h2>
                     <a id="a000320"></a>
                     <div class="entry" id="entry-320">
                        <h3 class="entry-header">Bluecat Build</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Building Bluecat from start including rebuilding the GNU Tools</li>

  <li>Proceeded through steps 1-4 but I still have problems at step 4</li>
</ul>
                              
                              <h3>Bluecat GNU Tools</h3>

<p>There are two "steps" that are not really steps and that are performed only in <i>automated</i> mode. Moscow had reccommended that we insert an exit statement in a certain location and run in automated mode (as root I can only assume) to get the Bluecat GNU Tools. I had originally subsetted this out and built them as int. However since I was having so many odd problems I decided to go strictly as Moscow instructs.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:40 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000320.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 15, 2005</h2>
                     <a id="a000317"></a>
                     <div class="entry" id="entry-317">
                        <h3 class="entry-header">BC Step 3 build failure</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Attempting to rebuild BC with new tag.</li>

  <li>Installed RH 8.0 on new machine</li>
</ul>
                              
                              <h3>Bluecat build failure in step 3</h3>

<p>I was asked to rebuild Bluecat using R_5_2_1_ppc_20050314 as a tag. I tried doing this but it is failing. I made it to step 4 when it was failing with something about unable to find /arch/ppc/Makefile or something like that. I decided to instead go back to the beginning and make the GNU Tools (step 0) just to be sure. Now I get stuck at step 3. It fails in an odd way too. In /usr/lynx/loc_archive under LOGS I have the following at the tail of the step3 log:</p>

<div class="code"><pre>
Building glibc package step 3.3 at 14:14:07
Done
Installing glibc package
Done
Building glib package step 3.4 at 17:06:12
parse_file: build_package failed for glib_cdt.spec
---- Step 3 finished successfully at Tue Mar 15 17:07:47 PST 2005 ----
+++ Exit .... +++
</pre></div>

<p>However in archive/20050314/ppc/logs/step3 for build_glib.log I have:</p>

<div class="code"><pre>
testglib.c:915: warning: const qualifier ignored on asm
.libs/libglib.so: undefined reference to `__ctype_b'
.libs/libglib.so: undefined reference to `__ctype_toupper'
.libs/libglib.so: undefined reference to `__ctype_tolower'
collect2: ld returned 1 exit status
make[2]: *** [testglib] Error 1
make[1]: *** [all-recursive] Error 1
make: *** [all-recursive-am] Error 2
error: Bad exit status from /usr/lynx/loc_archive/build/20050314/var/tmp/rpm-tmp.95118 (%build)
   Bad exit status from /usr/lynx/loc_archive/build/20050314/var/tmp/rpm-tmp.95118 (%build)
</pre></div>

<p>Do you know what is going wrong?</p>
<hr>
<h4>Later I wrote:</h4>

<p>Well rebuilding didn't help (I didn't think it would). Things seem to be failing in the rpm-tmp.<num> script. This script seems to be dynamically created. It sets some variables and basically does a configure and make in build/20050314/cdt/src/bluecat/BUILD/glib-1.2.10. This eventually boils down to the following gcc command:</p>

<div class="code"><pre>
[int@jaguar glib-1.2.10]$ gcc -O2 -g -march=i386 -Wall -D_REENTRANT -o .libs/testglib testglib.o .libs/libglib.so -Wl,--rpath -Wl,/cdt/lib
.libs/libglib.so: undefined reference to `va_copy'
collect2: ld returned 1 exit status
</pre></div>

<p>Oh, BTW, the old machine (penguin) has been renamed to jaguar but is otherwise the same.</p>

<p>I'm attempting to run step 3 again but I fear it'll just have the same error.</p>

<p>Note I will be monitoring email and this build from home so if you have any ideas send them right away.</p>

                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  3:41 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000317.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 14, 2005</h2>
                     <a id="a000316"></a>
                     <div class="entry" id="entry-316">
                        <h3 class="entry-header">NetSNMP/Bluecat build/Build Machine</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Rebuilt NetSNMP 5.1.1. Need to package src before build</li>

  <li>Restarted Bluecat build for new label</li>

  <li>Installing RH 8.0 on new machine</li>
</ul>
                              
                              <h3>NetSNMP 5.1.1</h3>

<p>We have a chicken and egg situation here. Apparently the src package needs to be built before the build happens, yet it also needs kern_mib.o and kern_mib.d.o, which you get <b>after</b> the build!. The scripts do not handle this gracefully so I rebuilt the packages by hand. Julia says the build is OK now but repeatability will be a problem</p>

<h3>Installation of RH 8.0</h3>

<p>After some initial trouble installing from CDROM (Needed to set IDE to Legacy in the BIOS) I managed to install RH 8.0. However I sized the root drive to only 2048 Meg. Turns out the RH 8.0 installation took 2020 Meg so I want to redo this. Upon reinstallation I'm again having problems with the CD. Seems the first CD has etchings on the outermost ring of the CD itself. Not sure if I caused this or if it was there before. May need to get anotehr CD for RH 8.0</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 11:36 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000316.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 11, 2005</h2>
                     <a id="a000315"></a>
                     <div class="entry" id="entry-315">
                        <h3 class="entry-header">NetSNMP</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Rebuilt NetSNMP.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:59 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000315.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March 10, 2005</h2>
                     <a id="a000314"></a>
                     <div class="entry" id="entry-314">
                        <h3 class="entry-header">Native x86 toolchain/Bluecat Installation/ECRD timeouts</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Discovered problems with Native x86 toolchain.</li>

  <li>Attempting Bluecat installation from CDs - taking a long time!</li>

  <li>Implemented timeouts correctly in ecrd, which was having client deadlocks every night</li>
</ul>
                              
                              <h3>Native X86 Toolchain Build Problem</h3>

<p>When building the toolchain on x86 natively I kept getting different failures. It was frustrating to say the least. Conferred with Adam and he remembered a problem with the kernel changing timestamps on files due to an nmap problem (ECR <a href="http://saturn/ecr/ecr.php?ecr=22905">22905</a>) which still seems to be a problem. Emailed Vlad about this...</p>

<h3>Bluecat installation from CDs</h3>

<p>Bluecat installation was takng a long time due to timeouts in NFS for a stale file handle for some remotely mounted CDROM. Still have an issue with one RPM that has int:staff ownership:</p>

<div class="code><pre>
    Installing BlueCat_ppc/cdt/RPMS/libgcc_cdt-3.2.2-1.i386.rpm
    error: failed to stat /mnt/qa: Stale NFS file handle
    warning: user int does not exist - using root
    warning: group staff does not exist - using root                              
    warning: user int does not exist - using root
    warning: group staff does not exist - using root
    warning: user int does not exist - using root
    warning: group staff does not exist - using root
    warning: user int does not exist - using root
    warning: group staff does not exist - using root
    warning: user int does not exist - using root
    warning: group staff does not exist - using root
    warning: user int does not exist - using root
    warning: group staff does not exist - using root
</pre></div>

<p>Note that this is the only package that this occurred on. It seems to verify Sasha's assertion that if the rpm's are not packaged by a native user then such warnings will occur. Still it seems odd that these "ppc" rpm's have "i386" in them...</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:21 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000314.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March  9, 2005</h2>
                     <a id="a000313"></a>
                     <div class="entry" id="entry-313">
                        <h3 class="entry-header">PPC Toolchain finally builds!</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Finally managed to build Native PPC Toolchain after many interruptions due to machine moves</li>

  <li>Revisiting build of Native X86 Toolchain which is failing.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:11 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000313.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March  8, 2005</h2>
                     <a id="a000311"></a>
                     <div class="entry" id="entry-311">
                        <h3 class="entry-header">netsnmp/t3 mount/PPC Toolchain</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Build NetSNMP 5.1.1</li>

  <li>Had Jeff export t3:/usr/lynx/archive/ecr so that ECRDig can gain access to auxilary files that people store there. Currently cat.php doesn't work with all the file types it can hit there.</li>

  <li>Figured out that the tar images were not being recreated due to int_tools getting stuck in the demos. Recreated PPC tar image and unpacked it onto target machine.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:03 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000311.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March  7, 2005</h2>
                     <a id="a000310"></a>
                     <div class="entry" id="entry-310">
                        <h3 class="entry-header">Bluecat CDs</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Burned 4 CDs for Bluecat</ii>

  <li>Continuing to hunt down problem with PPC Toolchain build. Missed a file. After including it libc.a does have atoi but it doesn't seem to be being packaged into the product image!</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 10:12 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000310.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March  4, 2005</h2>
                     <a id="a000309"></a>
                     <div class="entry" id="entry-309">
                        <h3 class="entry-header">Yet more building</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Finished Bluecat build process!</li>

  <li>Pulling ECR 23001 into the LynxOS build for eventual Native PPC Toolchain build</li>
</ul>
                              
                              <p>Regarding ECR 23001:</p>

<p>I was trying to build the native PPC toolchain again. The ECR I submitted was 23184 but that was dupped to 22979 which is in Pending Review state. So I pulled 22979 and attempted to build. But 22979 depends on 23001 (also in Pending Review). Is it OK to pull 23001 and continue onward? How are dependencies between ECRs normally handled?</p>

<blockquote>
  <p><b>Note:</b> I say "depends on" but I'm not sure that that is the right terminology. I don't really believe that 23001 depends on 22979 nor vica versa rather there doesn't seem to be a clear process here. 22979 pulls in src/lib/libc/Makefile revision 10.25 but 10.24 has a change for 23001 in it. So 23001 is needed because of this. The other files involved in 23001 do not have the Lion_lynxos_012405 tag so they are not picked up in the normal build process - hence the build fails. This is not a classic dependency rather it's an overrunning of checkins. Of course, maybe my analysis of this situation is flawed.</p>
</blockquote>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  1:53 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000309.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March  2, 2005</h2>
                     <a id="a000308"></a>
                     <div class="entry" id="entry-308">
                        <h3 class="entry-header">Building, building...</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Pulled ECR 22979 and rebuilt lynxos</li>

  <li>Placed new LynxOS on T3 and updated t-mcpn765-1</li>

  <li>Rebuild of Toolchain still fails with unresolved references to atoi!</li>

  <li>Found some corruption in LynxOS CVS. Working to get a list of files and to have this fixed</li>

  <li>Bluecat build, step 4 still failing...</li>

  <li>Attempting to build TOB Toolchain on x86 still failing</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:26 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000308.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">March  1, 2005</h2>
                     <a id="a000307"></a>
                     <div class="entry" id="entry-307">
                        <h3 class="entry-header">More BC building</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Moscow's BC build failed in step 4 due to lack of disk space. Moved guest account over to new partition</li>

  <li>Step 4 is not building for me either. Emailed Moscow</li>

  <li>Returning to other builds. PPC Native Toolchain build was failing - attempting to resolve that. Also X86 Native Toolchain build also failing.</li>

  <li>Several enhancements to ECR Dig:</li>

    <ul>
      <li>ECRs now include status line with Status, State and Severity</li>

      <li>Http and ftp references are made into links</li>

      <li>ECR numbers are now made into links</li>

      <li>Added footer with "Back to ECR Dig" link</li>
    </ul>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:41 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000307.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
