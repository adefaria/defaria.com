<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml"$>" />

   <title>Status for Andrew DeFaria: May 2005 Archives</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/2005_04.html" title="April 2005" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/2005_06.html" title="June 2005" />
</head>
<body class="layout-one-column">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">
                     
                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/2005_04.html">&laquo; April 2005</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/2005_06.html">June 2005 &raquo;</a>
                     </p>
                     
                     
                     

                     <h2 class="date-header">May 26, 2005</h2>
                     <a id="a000364"></a>
                     <div class="entry" id="entry-364">
                        <h3 class="entry-header">Build notes LW/GD and tst</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Caught up on build notes for 20050425, 20050519 and 20050525 for LW LOS178</li>

  <li>Resolved CR 41</li>

  <li>Tagged tst's for LW LOS178</li>

  <li>Assisted Adisak with lists for CRs 536 and 584</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:09 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000364.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 25, 2005</h2>
                     <a id="a000363"></a>
                     <div class="entry" id="entry-363">
                        <h3 class="entry-header">LW & GD builds</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Incorporated CR 598 which fixes the production build</li>

  <li>Tagged LW LOS178 20050525, rebuilt, released</li>

  <li>Ported CR 598 to GD</li>

  <li>Tagged GD LOS178 20050525, rebuilt, released</li>

  <li>Created build_notes for GD 20050428</li>

  <li>Associated updating of related CRs</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:38 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000363.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     
                     <a id="a000362"></a>
                     <div class="entry" id="entry-362">
                        <h3 class="entry-header">PPC Pdn build Failure/CVS Report bug</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Was unable to build ppd_pdn due to a bug</li>

  <li>Found a bug in cvs_report regarding new directories</li>
</ul>
                              
                              <h3>cvs_report bug</h3>

<p>The cvs_report script determines what has changed by using cvs update, just like the old one. But it uses -n to not actually update the area. If it did actually update it then it would have to downdate it (for lack of a better term) for the next night's run. But there is a side effect to not doing the actual update: If there is a new directory the -n will prevent cvs update from looking into what's in the new directory! I did not know this.</p>

<p>This effects CR #570 and possibly others. CR #570 adds a new directory under src/lib/libm called complex with 52 new files. These files did not get included in the list of files to port over.</p> 

<p>Additionally cvs_report had an error in a regex such that it was not identifying these new files properly. This has also been fixed.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:30 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000362.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 23, 2005</h2>
                     <a id="a000361"></a>
                     <div class="entry" id="entry-361">
                        <h3 class="entry-header">files4cr</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>Both files4ecr and files4cr will suffer this same problem. Let's say we had an E/CR with 10 files modified.  If at some later time one of these 10 files is changed, or another file modified with this same E/CR number it will show up in the CVS Report as only that one file modified since the CVS Report goes from some base tag to some other tag (e.g. head). The difference between those tags is only that one file - rightfully so.</p>

<p>However both files4ecr and files4cr work off of the E/CR number identifying <b>all</b> files associated with that E/CR number, irrespective of any other tags that they might have. So the files4cr in the above scenario would pick up all 11 files!</p>

<p>Now according to CVS a commit command should not commit files that have not been modified. The question is what does CVS use to determine that a file has been modified? Contents modified or just say date/timestamp modified? It appears that it's content modified</p>

<p>Still this makes files4[e]cr not very efficient. For example, CR #542 consists of ~3200 files that were modified. Since the last dev build 17 more files were modified. But files4cr picks up ~3200 files! If we are to transfer these over to GD then commit that seems like a large waste of effort</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  2:10 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000361.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 20, 2005</h2>
                     <a id="a000360"></a>
                     <div class="entry" id="entry-360">
                        <h3 class="entry-header">LinuxABI/CVS Report - Changes Only</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Need to have a PowerMac G5 with Yellow Dog Linux 4.0 to build LinuxABI</li>

  <li>Improved cvsr.php to support reports that contains only the changes from the last report.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  2:38 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000360.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 19, 2005</h2>
                     <a id="a000359"></a>
                     <div class="entry" id="entry-359">
                        <h3 class="entry-header">LOS178 TOT</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Tried building LOS178 - CR #570 again. This time by date. Turns out dates in CVS are UTC and you gotta subtract 7 hours from them - Argh!</li>

  <li>Managed to build LOS178 TOT (i.e. + CR #570). Some other CRs were checked in to resolve past build problems</li>

  <li>Started to package up stuff (still need to create CR for this) with new packaging script. Found out I needed to build pdn. Pdn build fails!</li>
</ul>
                              
                              <h3>OpenSSL</h3>

<p>Regarding the openssl problems: With the inclusion of the new TCP/IP stack comes openssl. When building on GD we experienced a problem where when building openssl it tries to regenerate certs. Since some parts of openssl use absolute pathnames and since Tomcat had a /usr/local/ssl directory we theorized that due to the existence of that directory the build of openssl tried to regenerate certs. Since the new certs were not required and were not functionality we said that that error was of no consiquence.</p>

<p>Turns out that what it really happening is that the openssl portion of the build will try to regenerate certs regardless of the presence of /usr/local/ssl and it does so by executing src/net/openssl-0.9.6/apps/openssl. This file is a Linux binary so building on Solaris causes errors. This explains why I keep seeing this as I am building on Rock and Vinnie doesn't see this since he is building on a Linux system.</p>

<p>Later Vinnie points out:</p>

<blockquote>
<p>Here is what is happening the apps/openssl is actually a los178 binary which we build & install in $(ENV_PREFIX)/usr/ssl/bin, but is being executed to generate the  certificates on a Solaris or Linux host which is not going to work. The problem is happening on both host except on linux the error is different and our check script does not have that  error message in the list. We need to update the script to capture the linux error string.</p>

<p>On linux host the error is:</p>

<blockquote>
     ": cannot execute binary file"
</blockquote>

<p>On Solaris host the error is</p>
 
<blockquote>
     ": syntax error at line 1: `(' unexpected"
</blockquote>

<p>File a CR for this problem and maybe suggest the two option below.</p>

<p>There are two options to fix this issue:</p>

<ol>
  <li>Disable generating the certificates in the Makefile since the pre-generated certificates files are checked-in/available, but these files needs to be installed in usr/ssl/certs</li>

  <li>Generate the certificates, but the appropriate openssl should be installed in the host system & pass the openssl path to the Makefile command.</li>
</ol>
</blockquote>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  2:35 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000359.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 18, 2005</h2>
                     <a id="a000358"></a>
                     <div class="entry" id="entry-358">
                        <h3 class="entry-header">LOS178-570/int/package and check</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Attempting to build LOS178 - CR 570 (Posix)</li>

  <li>Tried to make changes for package.sh. Problems are:</li>

  <ol>
    <li>Waiting for CR fom Moscow to address including of libstdc++ for LOS 2.1.0</li>

    <li>GD lacks libstdc++ from ppc.cdksol.tar.gz! Entered CR #38 for that</lii>

    <li>It was thought that changes to package.sh could be made without the need for a CR. Unfortunately the CVS setup is such that a CR is required, even for comitting changes to toolbox</li>
  </ol>

  <li>Described new scripts for check and package. Check can be used to help tally the number of growing warnings</li>

  <li>Described plan for a /int area so as to centralized our tools and scripts</li>
</ul>
                              
                              <h3>Check and Package</h3>

<p>I've done a little work on trying to come up with more generic scripts that can be used across build machines or indeed the organization. Specifically I've been targeting things like packaging and checking. My scripting language of choice is Perl.</p>

<p>All scripts are relative to my machine at present at saturn:/int. You are free to mount this file system from my machine to your machine to check out the code. In the future I plan on putting this all into a cvs repository and making if available to all who want/need it via a global file system such that adding /int/bin and perhaps /int/adm/bin to one's PATH is all that is needed to gain access to these scripts on any machine. Details of this will be forthcoming in another email.</p>

<p>In this message I will only describe the check and package scripts. Other scripts, including such things as cvs_report, ecrc as well as web pages and scripts will eventually be documented probably through a series of web pages.</p>

<h4>Check script</h4>

<p>Jas had asked me to enhance the checking of install.logs so as to keep track of the growing number of warnings. The check script does this. It will check for errors using the common error strings of other check like scripts as well as warning and optionally issue a total number of errors and warnings. The check script is in /int/bin/check. Here's a short usage:</p>
<div class="code"><pre>
    Usage: check [-u] [-v] [-d] [-t] [-w] <logfile [logfile]>

    Where:

            -u              Display usage
            -v              Turn on verbose mode
            -d              Turn on debug mode
            -t              Display total line
            -w              Include warnings
            <logfile>       One or more log files to check
</pre</div>
<p>With no options except logfile(s) check will output nothing but set the return status to the number of errors encountered. This allows future script to be able to use this in their script and just check the return status.</p>

<h4>Package script</h4>

<p>The idea here is to separate the definition of a package from the packaging code itself. The hope is to hand the package definition over to the developers themselves so that they can maintain that - after all they know better what goes where than we do.</p>

<p>Packaging is implemented as a module, specifically a Perl module and as a Perl object itself. The idea is to encapsulate what can be done with a package into an object. The object module is at /int/lib/LWPackage.pm. The "LW" stands for "LynuxWorks". An LWPackage object currently has 3 methods: new, list and package. The new method is called to create a new package object. One parameter must be specified, that being a pathname to a package spec file. That package spec file is parsed and the package object is populated. The list method will list all of the information about the package including the file list. Finally the package method produces the package image itself.</p>

<p>Here is a small Perl snippet that utilizes the LWPackage methods:</p>
<div class="code"><pre>
    my $pkg = LWPackage->new (spec => $spec);
    $pkg->list if get_verbose;
    $pkg->package;
</pre></div>
<p>In fact that's the main code for /int/bin/package, the packaging script. It creates a new LWPackage using the filename in $spec, calls the list method if verbose is turned on (get_verbose is part of the Display package) then calls the package method to create the package image.</p>

<h4>Package spec file</h4>

<p>Package spec files are denoted by the .lwp extension convention. The format of the spec file is pretty simple. As usual "#" indicate comments, etc. Look at /int/spec/* for example files. Basically the format is similar to:</p>
<div class="code"><pre>
    Name:       int
    Version:    1.0
    ProductNbr: 1000
    Release:    00
    Base:       /int
    Fileset:
        *
        -data
    EndFileset
</pre></div>
<p>Name, ProductNbr, etc. are used in the creation of the image file name ($ProductNbr-$Release.$Name.$Version.tar.gz). The Fileset section defines the file sets included in the package relative to Base. An "*" denotes the usual connotation of "everything". Other path names could be listed one by one. For example, I could have:</p>
<div class="code"><pre>
    Fileset:
        adm
        bin
        spec
        -data
        -web
    EndFileset
</pre></div>
<p>A minus sign does what you'd think - remove files denoted by this. So the above says, "everything under $Base except everything under $Base/data".</p>

<p>As for Fileset lines you can list multiple lines and they are processed in the order that they are entered. Duplicate filenames are removed and the Fileset list is ultimately sorted. You can list either directory names for whole directories (that are recursively processed) or individual file pathnames. Regex's are not supported (yet but should be).</p>

<p>The idea of a package spec is to define the Fileset from where they stand thus eliminating the need to copy large quantities of data into an alternate area so that that alternate area is "clean". IOW it should be able to pull only those necessary files from even a CVS or build tree directly. To that extend future arrangement of things into distinct areas will make writing packaging specs easier.</p>

<h3>A plan for /int</h4>

<p>We are seeking an NFS mountable global area where we can place various tools and scripts that will help us do our job. A previous email about the check and packaging scripts are an example of this. The basic idea is to be able to mount a global file system area to a short named path on the local system so that scripts like package and check, etc are accessible and readily available when needed.</p>

<p>So, for example, if t3:/export/int were that globally accessible file system one would mount t3:/export/int /int and then add /int/bin and perhaps /int/adm/bin to their path and these scripts would be available.</p>

<p>As these scripts will be used in business processes they are as valuable as our products themselves and thus should be placed under CVS. Let's assume that t3:/cvs/int-cvs were the CVS repository for these scripts. We could check out and modify our own scripts as we further develop them. A nightly cronjob could be set up to cvs export -r &gt;RELTAG&lt; /export/int to make sure that /export/int reflects <RELTAG> where &gt;RELTAG&lt; is some release tag. Then people could check out and enhance/modify our scripts in a test like environment and when "released" simply move the &gt;RELTAG&lt; to the committed version. The updated version would be available the next day (or we could force it by hand if necessary).</p>

<p>As for what gets put into /int I see the following directory structure:</p>

<blockquote>
<b>adm:</b> Administrative area
  <blockquote>
  <b>bin:</b> Administrative bin scripts<br>
  <b>data:</b> Any adm data files that you might need<br>
  <b>etc:</b> Rough equivalent of /etc<br>
  <b>functions:</b> bash script functions (currently symlinked to ../functions)
  </blockquote>
<b>bin:</b> Scripts and apps for int<br>
<b>data:</b> Any data you might want<br>
<b>functions:</b> bash script functions<br>
<b>lib:</b> For Perl and other library modules<br>
<b>spec:</b> Spec files (may get rid of this)<br>
<b>test:</b> Any test scripts. For example, test script to test the functionality of the modules in ../lib<br>
<b>web:</b> Might want to move this elsewhere. Basically a replica of the web pages and scripts I've been doing (so as to have a copy)
</blockquote>

<p>Of course this can change and evolve over time. The main idea is to have a standard place that is globally accessible and short pathed (you could easily type /int/bin/check if /int/bin is not in your path) at a well known path name. Also to sort of replicate or mimic the OS's standard directories like bin, etc, and the like so that it's easily understandable and "natural".</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:27 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000358.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 17, 2005</h2>
                     <a id="a000357"></a>
                     <div class="entry" id="entry-357">
                        <h3 class="entry-header">LOS178 TOT</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Attempted to build LOS178 TOT. Not successful</li>

  <li>Need to check in changes for package.sh for all of LOS 3.0.0, 2.1.0 and GD</li>
</ul>
                              
                              <h3>Package.sh changes</h3>

<p>Vinnie pointed out that the packaging script for LOS178 fails to include libstdc++.a. I've looked into this and found that while libstdc++.a is part of 2.1.0, 3.0.0 and GD the packaging script for all 3 failed to include libstdc++.a in the tar images. Further, 3.0.0 includes CR 542, the new TCPIP stack, yet the packaging script does not package up the new TCPIP stack. GD also included the new TCPIP stack ported under CR 15 and I had modified the packaging script on GD to do that.</p>

<p>Here's what I think should happen:</p>

<h4>For LOS178 2.1.0:</h4>

<ul>
  <li>Change the packaging script to include lib/libstdc++.a and lib/thread/libstdc++.a. This script will live on the REL_LOS178_2p1p0-branch.</li>

  <li>What CR should this be done under?</li>

  <li>Since there will probably be a rebuild of 2.1.0 do not repackage at this time.</li>
</ul>

<h4>For GD:</h4>

<ul>
  <li>Change the packaging script for GD to include lib/libstdc++.a and lib/thread/libstdc++.a.</li>

  <li>Check in those changes under CR 15 (?).</li>

  <li>Repackage GD.</li>
</ul>

<h4>For LOS178 3.0.0:</h4>

<ul>
  <li>Back port the GD packaging script to 3.0.0.</li>

  <li>Check in under CR 542 (?).</li>

  <li>Repackage 3.0.0. This will fix both the problem of not packaging the new TCPIP stack as well as including the libstdc++ components.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:19 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000357.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 16, 2005</h2>
                     <a id="a000356"></a>
                     <div class="entry" id="entry-356">
                        <h3 class="entry-header">GD Build Doc</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Updated GD Build Document</li>

  <li>Starting making a more standardized <i>check</i> script to check for errors as well as warnings and return a count</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:00 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000356.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 13, 2005</h2>
                     <a id="a000355"></a>
                     <div class="entry" id="entry-355">
                        <h3 class="entry-header">LOS178 TOT Build</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Attempted to build LOS178 TOT which is failing</li>

  <li>Attempted to build LOS 178 TOT for Linux cross. Also failing</li>

  <li>Updated <i>FCS ICS Hybrid OS Build Procedure</i> document</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:45 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000355.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 11, 2005</h2>
                     <a id="a000354"></a>
                     <div class="entry" id="entry-354">
                        <h3 class="entry-header">CVS Reports</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Implemented many improvements to cvs_report.pl</li>

  <li>Implemented some improvements to cvsr.php</li>

  <li>Re-performed steps 1, 8-12 of BC build in order to pickup changes to tests and demos. Made new images available at <a href="ftp://saturn">ftp://saturn</a>.
</ul>
                              
                              <h3>CVS Report Improvements</h3>

<p>Main problem addressed is that certain ECRs (or CRs) would show up if they were imported from a <i>vendor</i> branch. In general handling of revisions on branchs were not working very well. Other improvements include:</p>

<ul>
  <li>Changed to use Display package</li>

  <li>While cvs_report.pl tries to avoid doing cvs update or recreating the cvs area it is possible that tags could move thus cvs_report.pl should refresh the cvs area in case the baseline tag has moved.</li>

  <li>The special tag HEAD is ill defined under CVS. If a file is branched and the baseline tag is on the branch then it turns out that HEAD means the branch's head (this is with cvs diff only). If the file's baseline tag is on the trunk then HEAD means the trunk's head. Additionally the special revision 1.1.1 means <i>vendor</i> branch and is an alias for 1.1. This special situation is now better handled.</li>

  <li>Changed the cvs diff --brief to use both from and to tags. Initially it was thought that if from tag didn't exist then cvs diff would complain about that. It does - sometimes. Ah the consistancy of cvs! Gotta love it! Still it's thought that it's better (clearer) to specify both from and to tags</li>

  <li>Detection of no change is now better handled</li>
</ul>

<h3>cvsr.php Improvements</h3>

<ul>
  <li>Now properly reports the latest revision when multiple revisions are checked in for the same ECR</li>

   <li>Changed to return 2 character status, one indicating if the file is new and one to indicate if the file has changed (since the last report). This allows us to have a new and changed file.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 12:36 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000354.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May 10, 2005</h2>
                     <a id="a000353"></a>
                     <div class="entry" id="entry-353">
                        <h3 class="entry-header">BC 5.3 on RH 8.0</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>Wrote the following to Sasha today:</p>

<p>I'm still trying to build BC on RH 8.0. Since I was successful at building BC 5.3 on RH 6.1 I figured I oughta try building BC 5.3 on RH 8.0. I am also building starting as root.</p>

<p>I've tried twice now and it continues to fail in step 4.1 building the kernel. The following appears in build_kernel.log:</p>
<div class="code"><pre>
+ echo BUILDING A KERNEL FOR pmac_g5...
+ cp /build/bluecat/build/20050429/cdt/src/bluecat/SOURCES/bluecat-pmac_g5.config arch/ppc/defconfig
+ rm -f .config
+ make mrproper
+ make oldconfig
/bin/sh: line 1: bc_native_gcc: command not found
make[1]: *** [scripts/basic/fixdep] Error 127
make: *** [scripts_basic] Error 2
error: Bad exit status from /build/bluecat/build/20050429/var/tmp/rpm-tmp.94728 (%build)
    Bad exit status from /build/bluecat/build/20050429/var/tmp/rpm-tmp.94728 (%build)
</pre></div>
<p>Apparently var/tmp/rpm-tmp.94728 is a build script built on the fly then executed. bc_native_gcc does exist in /usr/src/bluecat/eng/bluecat/bc_misc but this script can't find it.</p>

<p>Ideas?</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  9:22 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000353.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May  9, 2005</h2>
                     <a id="a000352"></a>
                     <div class="entry" id="entry-352">
                        <h3 class="entry-header">CVS Report bug</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>The more I look into CVS the less I understand. Perhaps you can help me...</p>

<p>For the file los178/sys/kernel/getmem.c I see the following:</p>
<div class="code"><pre>
saturn:cvs log getmem.c

RCS file: /cvs/los178-cvs/los178/sys/kernel/getmem.c,v
Working file: getmem.c
head: 1.2
branch:
locks: strict
access list:
symbolic names:
       DEV_LOS178_2p1p0_ppc_20050503: 1.1.1.1.2.1
       REL_LOS178_2p0p0-branch: 1.1.1.1.0.4
                 ...
       REL_LOS178RSC_2p0p0_ppc_FCS: 1.1.1.1
                 ...
saturn:cvs st getmem.c
===================================================================
File: getmem.c          Status: Up-to-date

  Working revision:    1.1.1.1
  Repository revision: 1.1.1.1 /cvs/los178-cvs/los178/sys/kernel/getmem.c,v
  Sticky Tag:          REL_LOS178_2p0p0_ppc_FCS (revision: 1.1.1.1)
  Sticky Date:         (none)
  Sticky Options:      -ko
</pre></div>
<p>In particular here notice that head says 1.2 but the current working revision is 1.1.1.1. The CVS Report does a:</p>
<div class="code"><pre>
saturn:cvs diff --brief -r HEAD getmem.c
saturn:
</pre></div>
<p>Does this mean that there is no difference between 1.1.1.1 and 1.2?!? However if I do:</p>
<div class="code"><pre>
saturn:cvs diff --brief -r 1.2 getmem.c
Index: getmem.c
===================================================================
RCS file: /cvs/los178-cvs/los178/sys/kernel/getmem.c,v
retrieving revision 1.2
retrieving revision 1.1.1.1
diff --brief -r1.2 -r1.1.1.1
Files /tmp/cvsvGa4M1 and /tmp/cvswGa4M1 differ
saturn:
</pre></div>
<p>Why is this so? Doesn't -r HEAD mean 1.2 in this instance?</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  2:59 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000352.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May  5, 2005</h2>
                     <a id="a000351"></a>
                     <div class="entry" id="entry-351">
                        <h3 class="entry-header">New CVS Reports</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>I spent some time improving the web based CVS Reports. As you know I recently added reporting for <a href="http://saturn.lynx.com/cvsr/bluecat_eng">Bluecat Eng</a> and <a href="http://saturn.lynx.com/cvsr/bluecat_pkgs">Bluecat Pkgs</a>. But I've also improved the detailed report (e.g. See the <a href="http://saturn.lynx.com/cvsr/bluecat_eng/index.php?file=20050505">05/05/2005</a> report for Bluecat Eng) in the following ways:</p>

<ul>
  <li>Report now accurately counts files in ECRs as well as the Total file count. Previously if foo.c was checked in as 1.2 then later foo.c was checked in as 1.3 both would be listed thus inflating the file count. This has been fixed.</li>

  <li>Changes of files since the previous report are now <font color="red"><b>highlighted</b></font>. This is a very useful thing because the first question you ask yourself when looking at a report is "What changed?". While this might seem trivial it required a lot of rewriting of the PHP code to accomplish this. Since this is just the PHP code that displays the report it has become immediately effective on all previous reports too!</li>
</ul>

<p>I encourage you to visit these reports. They really can be quite useful. Maybe we can finally turn off the daily email.... ?</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 11:42 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000351.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     
                     <a id="a000350"></a>
                     <div class="entry" id="entry-350">
                        <h3 class="entry-header">Changes to the LOS178/GD packaging scripts</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>Vinnie pointed out that the packaging script for LOS178 fails to include libstdc++.a. I've looked into this and found that while libstdc++.a is part of 2.1.0, 3.0.0 and GD the packaging script for all 3 failed to include libstdc++.a in the tar images. Further, 3.0.0 includes CR 542, the new TCPIP stack, yet the packaging script does not package up the new TCPIP stack. GD also included the new TCPIP stack ported under CR 15 and I had modified the packaging script on GD to do that.</p>

<p>Here's what I think should happen:</p>

<h3>For LOS178 2.1.0:</h3>

<ul>
  <li>Change the packaging script to include lib/libstdc++.a and lib/thread/libstdc++.a. This script will live on the REL_LOS178_2p1p0-branch.</li>

  <li>What CR should this be done under?</li>

  <li>Since there will probably be a rebuild of 2.1.0 do not repackage at this time.</li>
</ul>

<h3>For GD:</h3>

<ul>
  <li>Change the packaging script for GD to include lib/libstdc++.a and lib/thread/libstdc++.a.</li>

  <li>Check in those changes under CR 15 (?).</li>

  <li>Repackage GD.</li>
</ul>

<h3>For LOS178 3.0.0</h3>

<ul>
  <li>Back port the GD packaging script to 3.0.0.</li>

  <li>Check in under CR 542 (?).</li>

  <li>Repackage 3.0.0. This will fix both the problem of not packaging the new TCPIP stack as well as including the libstdc++ components.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 11:19 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000350.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May  4, 2005</h2>
                     <a id="a000349"></a>
                     <div class="entry" id="entry-349">
                        <h3 class="entry-header">BC Build failure</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Attempted full su build of BC from scratch</li>

  <li>Changed CVS Reports to highlight the differences between this report and the previous one</li>
</ul>
                              
                              Andrew DeFaria wrote:

<blockquote type=cite>
<p>I was asked to build BC 5.3 so I started doing that yesterday (5/2). Today, thanks to the CVS Reports, comparing 20050502 and 20050503, I noticed a few files were checked in yesterday. Specifically int/etc/bc_build_packages and int/etc/build_trg.rc.pmac_g5. Since my build is already started I'm wondering what effect these checkins have.</p>
</blockquote>

<p>There is yet another new checkin for int/etc/additional_bc_packages today.</p>

<p>Also, I attempted the build as root this time from the start hoping that picking up these new checkins would allow the build to succeed. Strangely it failed at step 4.71, building nfs-utils:</p>

<div class="code"><pre>
rpc_sample.c:32: warning: `sccsid' defined but not used
getiversion.o: file not recognized: File format not recognized
collect2: ld returned 1 exit status
make[2]: *** [getiversion] Error 1
make[1]: *** [all] Error 2
make: *** [all] Error 2
error: Bad exit status from /usr/lynx/loc_archive/build/20050429/var/tmp/rpm-tmp.28759 (%build)
    Bad exit status from /usr/lynx/loc_archive/build/20050429/var/tmp/rpm-tmp.28759 (%build)
</pre></div>

<p>I'm not sure how to proceed with the BC build at this point.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 10:04 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000349.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May  3, 2005</h2>
                     <a id="a000348"></a>
                     <div class="entry" id="entry-348">
                        <h3 class="entry-header">BC Build & LOS178 2.1.0 TOB</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Attempted build of Bluecat 5.3. Build failed in 4.102. New checkins happened so I will attempt a rebuild</li>

  <li>Built and released LOS178 2.1.0 TOB</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  3:07 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000348.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">May  2, 2005</h2>
                     <a id="a000347"></a>
                     <div class="entry" id="entry-347">
                        <h3 class="entry-header">BC 5.3 20050429 drup</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Worked on building the 20050429 drop of BC 5.3</li>
</ul>
                              
                              <p>I was told to rebuild BC 5.3 as there have been changes that have been checked in. In talking with Sasha I learned that I should login as root and run the do_it script. Sasha said I can specify -h int@t3 to use the int user for CVS checkouts. The do_it script should su to the appropriate users at the appropriate times, etc...</p>

<p>One issue that I found before is one that I found where step 7 had a problem with /mnt/cdrom being already mounted, so I su'ed to root and umounted it. As this build procedure is so long I do not want to get through steps 1-6 only to hit a problem at step 7. I think, however, that step 7 should be enhanced to handle the possibility that /mnt/cdrom is already mounted or the instructions updated to reflect that /mnt/cdrom should not be mounted before starting the build script.</p>

<p>The next problem I had was that do_it su's to bin and attempts to create directories under archive and build for the date but it can't because these parent directories were previously created by int. Changed the owner to bin:bin.</p>

<p>Now I have a problem in that apparently the syntax of -t int@t3 does not work! Although do_it accepts this syntax and it does set CVSROOT to int@t3:/cm/CVS it then executes step 1 which su's to root (!) and eventually does a cvs export -r R_5_3_ppc_20050429 eng/int which fails because root cannot rsh to t3 without a password. Furthermore step 1 is a series of commands, the next of which executes bc_build_host_gnutools.sh which I suspect should be executed as root.</p>

<p>Switch back to starting do_it as the user int is no good because do_it first attempts to su to bin to create directories. int cannot su passwordless to bin. Catch 22!</p>

<p>To address this problem I changed the do_it script:</p>

<div class="code"><pre>
BUILD_CVS_OWNER=int
 ...
STEP1_CMD="cd $BC_SRC_PREFIX; su $BUILD_CVS_OWNER -c \"cvs export -r $BC_CVS_TAG eng/int\"; \
           $SCRIPTS_PREFIX/bc_build_host_gnutools.sh; \
           su $BUILD_CVS_OWNER -c \"$SCRIPTS_PREFIX/bc_cvs.sh\""
</pre></div>

<p>This addresses the cvs export command in STEP1_CMD however there's another problem: bc_build_host_gnutools.sh also issues CVS commands and they similarly fail with "permission denied" errors.</p>

<p>I believe the basic problem is this: BC utilizes CVS' :ext: method for accessing the repository. This method in turn utilizes the underlying transport mechanism of rsh (note that ssh can be used instead by setting CVS_RSH=ssh and, of course, you must have ssh installed - which jaguar does not). In order to use rsh as a transport you must have passwordless login via rsh as the user who executed the CVS command - not the user specification in CVSROOT!!! The Cederqvist seems to bear this out under it's troubleshooting section:</p>

<table border="0" cellpadding="2" cellspacing="0" width="100%">
    <tbody>
      <tr>
        <td valign="middle" width="100">:ext:</td>
        <td valign="top">Try running the rsh program from the command
line. For example: "rsh servername cvs -v" should print cvs version
information. If this doesn&#8217;t work, you need to fix it before you can
worry about cvs problems.</td>
      </tr>
    </tbody>
  </table>

<p>So even though CVSROOT says :ext:int@t3:/cm/CVS when a CVS command is run as the user root then the user root needs to be able to rsh to the server without specifying a password. This is a good argument for BC to be set up to use :pserver: instead of :ext: access to the CVS repository.</p>

<p>Changing step 1 to be executed entirely by BUILD_CVS_OWNER:</p>

<div class="code"><pre>
  STEP1_CMD="su $BUILD_CVS_OWNER -c \"cd $BC_SRC_PREFIX; \
             cvs export -r $BC_CVS_TAG eng/int; \
             $SCRIPTS_PREFIX/bc_build_host_gnutools.sh; \
             $SCRIPTS_PREFIX/bc_cvs.sh\""
</pre></div>

<p>Argh! That's not gonna work because bc_build_host_gnutools.sh wants to write out files to directories owned by bin!</p>

<p>I think I'm gonna go back to my stepwise method for now. Still this stepwise method produces RPMs that have ownership problems (files in RPMs are owned by int:staff instead of bin:bin).</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  2:57 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000347.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
