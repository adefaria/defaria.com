<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml"$>" />

   <title>Status for Andrew DeFaria: June 19, 2005 - June 25, 2005 Archives</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/week_2005_06_12.html" title="June 12, 2005 - June 18, 2005" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/week_2005_06_26.html" title="June 26, 2005 - July  2, 2005" />
</head>
<body class="layout-one-column">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">
                     
                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/week_2005_06_12.html">&laquo; June 12, 2005 - June 18, 2005</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/week_2005_06_26.html">June 26, 2005 - July  2, 2005 &raquo;</a>
                     </p>
                     
                     
                     

                     <h2 class="date-header">June 23, 2005</h2>
                     <a id="a000377"></a>
                     <div class="entry" id="entry-377">
                        <h3 class="entry-header">Building CDK under Windows</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Build Windows version of the CDK</li>

  <li>Submitted CR 659: cdk tool mkimage fails to build under Windows</li>
</ul>
                              
                              <h3>Building Windows CDK</h3>

<p>In order to build the CDK under Windows one must use an ancient version of Cygwin - B20 (it is assumed that that is already installed). Additionally one must perform certain actions in a certain order:</p>

<ol>
  <li>Obtain the latest versions of the following tar images from the archive area:
    <ul>
      <li>2000-00.los178_rsc_src.tar.gz</li>

      <li>2001-00.los178_src.tar.gz</li>

      <li>2013-00.los178_dev.tar.gz</li>

      <li>2015-00.los178_rsc_dev.tar.gz</li>

      <li>(From cvs bin-image) ppc.cdkwin32.tar.gz</li>
    </ul>
  </li>

  <li>Create an area to do the build and extract the above into that area</li>

  <li>Exit this bash shell</li>

  <li>Start a cmd shell</li>

  <li>Execute the VCVARS32.BAT file. This is normally found in C:\Program Files\Microsoft Visual Studio\VS98\Bin. Note that this implies that Visual Studio is also installed. Also, often people will copy this bat file to C:\ for easier execution. This bat file sets certain environment variables including PATH such that nmake can be found. Under Windows we lean on VS's nmake. Also, this must be done from a cmd shell before starting Cygwin so that the changes to the environment can be picked up. Why don't we just make a script or enhance SETUP.bash to take into account for this?</li>

  <li>Start Cygwin using the appropriate cygnus.bat file. This was given to me by Moscow. Doesn't seem to do that much fancy stuff:

<div class="code"><pre>
@ECHO OFF
SET TARGET_PATH=C:\LynuxWorks\2.0.0
SET MAKE_MODE=UNIX
SET TERM=cygwin
SET HOME=/

set PATH=%TARGET_PATH%\bin;%TARGET_PATH%\usr\bin:%PATH%

echo "TARGET_PATH is %TARGET_PATH%

if not exist %TARGET_PATH%\bin\sh.exe goto error_no_sh

ver > %TARGET_PATH%\_tmp
goto the_end

:error_no_sh
echo "Installation Error -- no %TARGET_PATH%\bin\sh.exe found"

:the_end
del %TARGET_PATH%\_tmp
bash
</pre></div>
  </li>

  <li>cd to the directory that you created to perform the build</li>

  <li>Source SETUP.bash</li

  <li>cd to src/cdk</li>

  <li>make install > install.log 2>&1</li>

  <li>Check install.log for errors</li>
</ol>

<h3>CR 659: cdk tool mkimage fails to build under Windows</h3>

<p>Build of cdk tool mkimage files under Windows. This is a make install in src/cdk of LOS178. The specific error is:</p>

<div class="code"><pre>
Compiling coff.o
coff.c
coff.c(91) : fatal error C1083: Cannot open include file: 'family/ppc/arch_mem.h': No such file or directory
NMAKE : fatal error U1077: 'cl.exe' : return code '0x2'
Stop.
make[1]: *** [WIN32_VS_UTIL] Error 2 
</pre></div>

<p>Problem seems to be that the fix for src/cdk/common/mkimage/Makefile in CR #539 of adding -I$(ENV_PREFIX)/sys/include does not work under Windows with nmake.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 10:35 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000377.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">June 22, 2005</h2>
                     <a id="a000376"></a>
                     <div class="entry" id="entry-376">
                        <h3 class="entry-header">LOS178 2.1.0 build</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>After two bugs in the GDB 6.0 build process on Solaris were fixed I was finally able to build GDB 6.0 on Solaris</li>

  <li>Built LOS178 for both dev and pdn</li>

  <li>Packaged up and released onto t3</li>

  <li>Tagged release with DEV_LOS178_2p1p0_ppc_20050622</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  7:19 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000376.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">June 21, 2005</h2>
                     <a id="a000375"></a>
                     <div class="entry" id="entry-375">
                        <h3 class="entry-header">LOS178 2.1.0 + GDB</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Managed to build los178 for dev and pdn. Pdn still has CONSOLE_DEVICE error on ibm44ep.</li>

  <li>Working with Adam re: GDB build on Rock</li>
</ul>
                              
                              <h3>Rock (Solaris) build</h3>

<p>Building on Rock is building on Solaris. We have to rebuild parts of the cdk by cd'ing into src/cdk and doing make install. This puts stuff into the cdk/<host>-[xcoff|elf]-<target> area. Now on Linux everything builds OK and I believe we also did the Window portion too. But Solaris was yet undone.</p>

<p>Turns out that not much builds successfully on Solaris but all that is required at this time is mkimage. With mkimage successfully built the process of building LOS178 on Solaria remains largely the same in that you checkout/export the sources and untar the ppc.cdksol.tar.gz. The difference is that you inject your newly built mkimage into the cdk area before building.</p>

<h3>Packaging and Structuring</h3>

<p>Vinnie attempted to describe the packaging structuring. I'm still not sure i have it all in my head yet but here goes:</p>

<p>Note that we are only currently building for release on Rock or Solaris. Still cdk's for other targets need to be built and included. Also, we use the bin-image/ppc.cdk<host>.tar.gz prebuilt software for building things and we also package up cdk tarballs in the release area (e.g. 2011-01.cdksol.tar.gz).</p>

<p>For GDB we must source SETUP.bash pointing to some LOS178 area and then we go to the toolchain and make install-gdb. The end result of this build are two executables, one of which we are concerned with - gdbserver. However there are also various things deposited in the cdk for gdb, the client and for insight and Tcl/Tk stuff.</p>

<p>The gdbserver and it's client require packaging of Linux, Windows and Solaris cdk's that contain the necessary gdb parts. The current package.sh should automatically handle this because it packages up things based on directory names.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  3:57 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000375.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">June 20, 2005</h2>
                     <a id="a000374"></a>
                     <div class="entry" id="entry-374">
                        <h3 class="entry-header">2.1.0 GDB Build</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Built LOS178 2.1.0 on Rock including CR638. Was able to build dev but not pdn.</li>

  <li>Having some problems with GDB build on Solaris</li>
</ul>
                              
                              <p>I was able to build LOS178 2.1.0 dev build on rock but had errors in building the pdn portion:</p>

<div class="code"><pre>
    rock:check -t -v ../los178.pdn/install.log
    ERRORS:
    conf.c(98) : error: `CONSOLE_DEVICE' undeclared here (not in a function)
    make[4]: *** [conf.o] Error 1
    make[3]: *** [re_all] Error 2
    make[4]: *** [common_all] Error 1
    make[3]: *** [re_all] Error 2
    make[4]: *** [a.out] Error 1
    make[3]: *** [re_all] Error 2
    make[2]: *** [real] Error 2
    make[1]: *** [install] Error 2
    File: ../los178.pdn/install.log Errors: 9 Warnings: 1140
    rock:pwd
    /export/home/adefaria/2.1.0/los178/los178.cvs
</pre></div>

<p>Also, I was only able to build mkimage for the cdk on Solaris. Vinnie says this is expected.</p>

<p>I have not managed to build gdb on Solaris, I'm working with Adam about that problem.</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  8:32 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000374.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
