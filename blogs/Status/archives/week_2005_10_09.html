<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml"$>" />

   <title>Status for Andrew DeFaria: October  9, 2005 - October 15, 2005 Archives</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/week_2005_10_02.html" title="October  2, 2005 - October  8, 2005" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/week_2005_10_16.html" title="October 16, 2005 - October 22, 2005" />
</head>
<body class="layout-one-column">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">
                     
                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/week_2005_10_02.html">&laquo; October  2, 2005 - October  8, 2005</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/week_2005_10_16.html">October 16, 2005 - October 22, 2005 &raquo;</a>
                     </p>
                     
                     
                     

                     <h2 class="date-header">October 15, 2005</h2>
                     <a id="a000451"></a>
                     <div class="entry" id="entry-451">
                        <h3 class="entry-header">PQA Clearquest: Resolving remaining issues with bad data</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <p>This is to document all of the issues related with bad data in the source databases that is impeeding the PQA Merge process. Along with the issues I will present what I did to work around the problems and what I suggest we should do to provide a smooth transition of these databases</p>
                              
                              <h2>Resolving Data Conversion Problems in PQA Database Merge</h2>

<h3>New fields that are mandatory</h3>

<p>The following fieilds are new in the destination database (Cont) and are also mandatory thus must be filled in with something:</p>

<ul>
  <li><b>Cont:Found_On_Gold:</b> This field is defaulted to <i>No</i>.</li>
</ul>

<h3>Fields with blank or invalid data</h3>

<p>The following fields have blank or invalid data in the source database thus fail validation when added to the new database:</p>

<ul>
  <li><b>TO:SQATestCase:</b> This field, when blank, is set to the string "N/A". This field is also renamed to <b>Cont:PQATestCase</b>.</li>

  <li><b>TO:Title_2:</b> This field, when blank, is set to the string "N/A". This field is also renamed to <b>Cont:TItle</b>.</li>

  <li><b>Prod:Software_Version:</b> This field, when blank, is set to the string "N/A".</li>

  <li><b>Prod:HUT_Version:</b> This field, when blank, is set to the string "N/A". This field is also renamed to <b>Cont:Board_Revision</b>.</li>

  <li><b>Prod:Software_Version:</b> This field, when blank, is set to the string "N/A".</li>

  <li><b>Prod:SQATestCase:</b> This field, when blank, is set to the string "N/A". This field is also renamed to <b>Cont:PQATestCase</b>.</li>
</ul>

<h3>Fields with data that are no longer valid in new database</h3>

<p>The following fields have data in the source database but fail validation when added to the new database due to reasons like not being on the list of acceptable values for the field in question:</p>

<ul>
  <li><b>Prod:Category</b> This field sometimes has the value of <i>Hardware</i> or <i>System Bios</i> which are not valid choices in the new database. For now I am changing <i>Hardware</i> -> <i>Hardware - Chip</i> and <i>System Bios</i> -> <i>Software</i>. I suggest we add <i>Hardware</i> and <i>System Bios</i> to the constant list as <i>HARDWARE</i> and <i>SYSTEM BIOS</i> (Capitalized) so we can easily find and correct these later.</li>

  <li><b>Prod:Issue_Classification:</b> This field sometimes has the value of <i>Hardware</i> which is not a valid choice in the new database. For now I'm changing <i>Hardware</i> -> <i>Requirement</i>. I suggest we add <i>Hardware</i> to the constant list as <i>HARDWARE</i> (Capitalized) so we can easily find and correct these later.</li>

  <li><b>Prod:Resolution:</b> This field sometimes has the value of <i>HW Fix</i> or <i>MAC Core</i> which are not valid choices in the new database. For now I am changing <i>HW Fix</i> -> <i>HW - Fix</i> and <i>MAC Core</i> -> <i>SW Fix</i>. I suggest we add <i>HW - Fix</i> and <i>MAC Core</i> to the constant list as <i>HW - FIX</i> and <i>MAC CORE</i> (Capitalized) so we can easily find and correct these later.</li>

  <li><b>Prod:HUT_Revision:</b> This field is sometimes set to "n/a". This is translated to "N/A" (note capitalization).</li>
</ul>

<h3>Fields that need truncating</h3>

<p>The following fields have data that is too large to fit in the size of the corresponding field in the destination database:</p>

<ul>
  <li><b>Prod:ActionNotes:</b> This field is defined with a maximum length of 50 characters in the TO database, 250 characters in the Prod database and 50 characters in the Cont database. Some entries in the Prod database are greater than 50 characters thus require truncation. I suggest that we increase the maximum length of <b>Cont:ActionNotes</b> to 250 characters to avoid this problem.</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:41 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000451.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">October 14, 2005</h2>
                     <a id="a000450"></a>
                     <div class="entry" id="entry-450">
                        <h3 class="entry-header">PQA Merge - Action Hooks & Attachments</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>There are action hooks in Cont that send out email. I fear my testing may be generating lots of unnecessary email. Would like to have the Action Hook's email procedures coded to be conditional based on say an env  var so we can turn off email during the production merge.</lI>

  <li>Attachments are currently not handled because they are different and require special code to iterate through them to copy them to the destination database</li>

  <li>Need to have the delete action available on the defect record so pqaclean can work. I've modified my schema for that</li>

  <li>Changed pqamerge to only get the dbid's then to obtain the entity records when needed. Previously I would build a query with all fields. That query took from 6-40 minutes to run before I could even obtain the first record! Also the memory size of Perl grew very big. This algorithm is much faster with the query taking under 1 second!</li>

  <li>Working on problems with the source data.</li>
</ul>
                              
                              <h3>Bad data. BAD DATA! Go sit in the corner!</h3>

<p>I'm discovering that not all the data in the source databases are clean to start with. For example, HUT_Version -> Board_Revision. in TO all defects have valid HUT_Versions. With Prod some of the HUT_Versions are blank! That's not good as that's an invalid value. For example, use Clearquest to bring up record Prod00002978's Board_Revision (It's shown in Clearquest as Board_Revision but is tied to the field HUT_Version) is blank. Select <strong>Modify</strong> and the field will be <font color=red>red</font>. On that same record you'll notice that <strong>Category</strong> is also <font color=red>red</font>. This is because <strong>Category</strong> is a <em>Constant list</em> and there is no <em>Hardware</em> in that constant list! There are <em>Hardware - Board</em> and <em>Hardware - Chip</em> however. Which do I choose?</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 11:14 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000450.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">October 13, 2005</h2>
                     <a id="a000449"></a>
                     <div class="entry" id="entry-449">
                        <h3 class="entry-header">PQA Merge</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Added Display, Logger and new TimeUtils to pqaclean and pqamerge</li>

  <li>Finally got ProjectExists() to work. Turns out I was using the wrong CQPerlExt constant causing pqamerge to blow up</li>

  <li>Received guidance from Vinh regarding certain field transformations. Incorporated them into pqamerge</li>

  <li>Pqamerge now merging all of TO:defect records with a few exceptions that I'm fixing</li>
</ul>

                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:09 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000449.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">October 12, 2005</h2>
                     <a id="a000448"></a>
                     <div class="entry" id="entry-448">
                        <h3 class="entry-header">PQA Clearquest: Project fields</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Started coding TransferDefects(). This is where the rubber hits the road</li>
</ul>
                              
                              <h3>Project Fields</h3>

<p>Queried Vinh:</p>

<p>Vinh, you may be seeing me asking more questions as I get into coding pqamerge. This email is about Project. Let me see if I understand this:</p>

<p>There are the following "project" related fields:</p>

<ul>
  <li><b>TO:Project:</b> Reference to Project stateless record. Since there are no Project records in the TO database I assume this field is not used and should be ignored from TO.</li>

  <li><b>Prod:Project:</b> There are records in Prod. I assume these should be translated to <b>Cont:Found_In_Project</b>.</li>

  <li><b>Prod:Project_Name:</b> Apparently not used  and should be ignored?</li>

  <li><b>TO:Found_In_Project:</b> Short string dynamic list consisting of <em>Release T2.0</em>, <em>Release T2.1</em>, <em>Release T2.5</em> and <em>Release T3.0</em>. I assume that this translates to <b>Cont:Found_In_Project</b> which is a reference to <b>Cont:Project</b>?</li>
</ul>

<p>There are other "project" related fields that I'm a little confused about:</p>

<ul>
  <li><b>TO:CommittedToProject:</b> Short string, dynamic list</li>

  <li><b>TO:DeferredToProject:</b> Short string, dynamic list</li>

  <li><b>Prod:CommittedToProject:</b> Short string, <u>constant</u> list</li>

  <li><b>Prod:DeferredToProject:</b> Short string, <u>constant</u> list</li>

  <li><b>Cont:CommittedToProject:</b> Short string, dynamic list</li>

  <li><b>Cont:DeferredToProject:</b> Short string, dynamic list</li>
</ul>

<p>Should all of these be changed to references to the Cont:Project stateless record?</p>

<h3>Values for new mandatory fields</h3>

<p>I've added routines to dynamically create those dynamic lists, however I am having problems with the following fields. These fields are new for Cont and are mandatory. Since I don't have old data to fill them in with I do not know what you want them to be set to. Here are the fields and my guesses:</p>

<ul>
  <li><b> Board_Revision:</b> Default value: ???</li>

  <li><b>Found_On_Gold:</b> This is a constant list of "Yes" or "No". I assume "No"</li>

  <li><b>PQATestCase:</b> This is a constant list of "Yes" or "N/A". I assume "N/A"</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 11:40 AM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000448.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">October 11, 2005</h2>
                     <a id="a000447"></a>
                     <div class="entry" id="entry-447">
                        <h3 class="entry-header">PQA Clearquest</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Resolved problems being able to log into the new Cont database by redoing the importation of CQSchema, CQ_Controller_Prod and CQ_Controller_Test</li>

  <li>Imported user accounts database from old schema to new schema. This was done by simply setting all users to all databases. While this is not what we will do for the production move it allows me to continue coding and testing</li>

  <li>Started coding pqamerge. Got to the point of being able to transfer Customer and Project records</li>

  <li>Coded pqaclean. This is a little script to effectively erase the destination database. This allows me to run pqamerge over and over from a clean slate. Had to add a delete action to the defect record</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  9:15 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000447.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">October 10, 2005</h2>
                     <a id="a000446"></a>
                     <div class="entry" id="entry-446">
                        <h3 class="entry-header">PQA Clearquest</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Hooked up new PQA schema database and data database</li>

  <li>Starting to code merge routines</li>

  <li>Created PQA Schedule (See below)</li>
</ul>
                              
                              <h3>Moving MS/SQL Databases</h3>

<p>Moving a MS/SQL Database from one host to another involves a bit of tweaking to get the new system to recognize that it has a new database. I will attempt to detail here what needs to be done. </p>

<p>In order to import Clearquest databases to a new MS SQL Database Server:</p>

<ol>
  <li>Place imported datafile onto new machine.</li>

  <li>Start the MS SQL Server Enterprise Manager (C:\Windows\system32\mmc.exe /s "C:\Program Files\Microsoft SQL Server\80\Tools\BINN\SQL Server Enterprise Manager.msc")</li>

  <li>Expand tree until you see "(local)" then "Databases". Right click on Database and select New Database to create an empty new database. Name the database appropriately. On the Data Files tab we changed the default path of C:\Program Files\Microsoft SQL Server\MSSQL\data\&lt;database name&gt;.mdf to a more approriate place. Also check the Transaction Log tab to adust path.</li>

  <li>Restore database by right clicked on the new database you created and selecting All Tasks: Restore Database. Under Restore select From Device then click Add then find the restored db file. Under Options change the paths for Move to physical file name.</li>

  <li>For Clearquest Schema databases only (You may need to restart the SQL Server Enterprise Manager after the above restore of the database): Since Clearquest uses a database to hold the schema and that schema points to known user databases, importing a Clearquest schema will have entries that point over to <b>projection</b> databases! These need to change:

    <ul>
      <li>In SQL Sever Enterprise Manager locate your imported schema database and double click on Tables.</li>

      <li>Find master_dbs, right click on master_dbs and select Open Table: Return All Rows.</li>

      <li>Change the server column to the name of the new server</li>

      <li>Select Run (the ! symbol in the toolbar)</li>
    </ul>

  <li>Folllow instructions at <a href="http://support.microsoft.com/default.aspx?scid=kb;%5bLN%5d;Q240872">How to resolve permission issues when you move a database between servers that are running SQL Server</a> for fixing permissions problems.</li>

  <li>Import user databases. Note the fix above regarding master_dbs:server is <b>not</b> required for user databases</li>
</ol>

<h3>Merge Routines and Connecting to Multiple Schemas</h3>

<p>With two schema databases I was having problems with my Perl script connecting to the databases. In the past I had:

<div class="code"><pre>
      ## Internal variables ##
      my $session;
      my $login           = "admin";
      my $password    = "*****";
      my $masterdb    = ""; # Don't need a masterdb (Using default?)
      my $db_name;
    ...
      sub StartSession {
        $db_name = shift;

        $session = CQPerlExt::CQSession_Build ();

        $session->UserLogon ($login, $password, $db_name, $masterdb);
      } # StartSession
</pre></div>

<p>Now when I run this in the presence of two schema databases I get:</p>

<div class=box>
    The database "MASTR" belonging to master database "2002.05.00" is an invalid name. Enter the correct name of a ClearQuest user database. at c:/Program Files/Rational/ClearQuest/lib/CQPerlExt.pm line 3713.
</div>

<p>I think I need to specify the proper $ masterdb name but I don't know what that might be... Hmmm... Seems that $masterdb is really just the Connection name that you'd see when you start Clearquest Designer or Clearquest Client and there are multiple schemas to choose from. That's odd because that could be potentially anything as the user could rename it. However if I use PQA_Old on p4test (which is what I named the old schema connection) then it works.</p>

<p>OK, more work on this tomorrow. I have already defined the new defect record in my Perl module. I just have to start coding the merge routines now...</p>

<h3>PQA Schedule</h3>

<p>The following is a rough estimate of the work needed to be completed to get to the point where we are ready to convert the live production databases</p>

<ul>
  <li> Restore new Schema DB and Data DB (<font color="#999">1 Day</font>)</li>

  <li> Investigate record/field mappings (<font color="#999">2 Days</font>)</li>

  <li>Determine order fo record additions (<font color="#999">1 Day</font>)</li>

  <li>Investigate requirements for adding of records to Clearquest (<font color="#999">2 Days</font>)</li>

  <li>Code/Test merge procedures (<font color="#999">3 Day</font>)</li>

  <li>Test conversion on <b>p4test</b> (<font color="#999">4 Days</font>)</li>
</ul>

<p><b>Total:</b> 13 Days</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at 12:11 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000446.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
