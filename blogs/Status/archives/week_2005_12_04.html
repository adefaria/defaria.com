<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="generator" content="Movable Type 5.2.3" />

   <link rel="stylesheet" href="http://defaria.com/blogs/Status/styles-site.css" type="text/css" />
   <link rel="alternate" type="application/atom+xml" title="Atom" href="http://defaria.com/blogs/Status/atom.xml" />
   <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://defaria.com/blogs/Status/index.xml"$>" />

   <title>Status for Andrew DeFaria: December  4, 2005 - December 10, 2005 Archives</title>

   <link rel="start" href="http://defaria.com/blogs/Status/" title="Home" />
   <link rel="prev" href="http://defaria.com/blogs/Status/archives/week_2005_11_27.html" title="November 27, 2005 - December  3, 2005" />
   <link rel="next" href="http://defaria.com/blogs/Status/archives/week_2005_12_11.html" title="December 11, 2005 - December 17, 2005" />
</head>
<body class="layout-one-column">
   <div id="container">
      <div id="container-inner" class="pkg">

         <div id="banner">
            <div id="banner-inner" class="pkg">
               <h1 id="banner-header"><a href="http://defaria.com/blogs/Status/" accesskey="1">Status for Andrew DeFaria</a></h1>
               <h2 id="banner-description">Searchable status reports and work log</h2>
            </div>
         </div>

         <div id="pagebody">
            <div id="pagebody-inner" class="pkg">
               <div id="alpha">
                  <div id="alpha-inner" class="pkg">
                     
                     <p class="content-nav">
                        <a href="http://defaria.com/blogs/Status/archives/week_2005_11_27.html">&laquo; November 27, 2005 - December  3, 2005</a> |
                        <a href="http://defaria.com/blogs/Status/">Main</a>
                        | <a href="http://defaria.com/blogs/Status/archives/week_2005_12_11.html">December 11, 2005 - December 17, 2005 &raquo;</a>
                     </p>
                     
                     
                     

                     <h2 class="date-header">December  9, 2005</h2>
                     <a id="a000494"></a>
                     <div class="entry" id="entry-494">
                        <h3 class="entry-header">Stripmime/IMS.pm</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Changed stripmime to perform logging if -v is present. Also debugged stripmime to the point where it seems to be properly being passed off the queue-pr</li>

  <li>Implemented IMS.pm - a more Perl-like interface to IMS. Also started implementing cvs_ims to be a connector between CVS <-> IMS</li>
</ul>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  4:43 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000494.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">December  8, 2005</h2>
                     <a id="a000493"></a>
                     <div class="entry" id="entry-493">
                        <h3 class="entry-header">Bin Merge updates/GNATS: Another word for "bug"! :-(</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Worked with David Dinh on getting Clearquest Windows Client on Citrix</li>

  <lI>Updated BinMerge to always draw the merge arrow to the branch we are merging to</li>

  <li>Fixed BinMerge's PerlTk portion to top the window iniitially</lI>

  <li>Worked with Ravi on Stripmime and GNATS</li>
</ul>
                              
                              <h2>BinMerge updates</h2>

<p>Updated BinMerge to always draw the merge arrow to the branch we are merging to. There was also a bug about the choice returned from the PerlTk portion where it needed to not only be chomped but chopped until there were no more "\n"'s there. Don't know why that happened.</p>

<p>Additionally the PerlTk window would often not pop to the top of the window stack. This is apparenty common under Windows. I implemented the following code:</p>

<div class="code"><pre>
    # Make sure the window pops to the top
    # Trying really hard... :-)
    $main->update;
    $main->deiconify;
    $main->update;
    $main->raise;
    $main->update;
    $main->focusForce;
    $main->update;

    MainLoop;
</pre></div>

<p>At least this heavy handed approach seems to work.</p>

<h2>Stripmime and GNATS</h2>

<p>Ravi and I worked on the stripmimed thing a little today. Here's what
happened:</p>

<ul>
  <li>We verified that stripmimed is indeed running. The alias was changed to not run Perl first rather to  use the shebang line. That was working - IOW /tools/gnats/4.0/bin/stripmimed would run. (later it broke).</li>

  <li>We verified that stripmimed was writing properly to stdout.</li>

  <li>We saw that /tools/gnats/4.0/SunOS/libexec/gnats/queue-pr was being run and a file was being deposited into /tools/gnats/db-test-it/gnats-queue.</li>

  <li>We saw that /tools/gnats/4.0/SunOS/libexec/gnats/queue-pr would be run by cron (or by hand) and it would process the file deposited in the queue</li>

  <li>After that we don't know where the information for this went. We were using Test/1 in the subject line which should update http://gnats-irva-3.broadcom.com/cgi-bin/gnatsweb.pl?debug=&amp;database=IT-Test&amp;cmd=edit&amp;cmd=edit&amp;pr=1
but it isn't.</li>
</ul>

<p>I attempted to debug this further and I made a change /tools/gnats/4.0/bin/stripmimed and now:</p>

<div class="code"><pre>
gnats-irva-3:/tools/gnats/4.0/bin/stripmimed
/tools/gnats/4.0/bin/stripmimed: line 44: use: command not found
/tools/gnats/4.0/bin/stripmimed: line 48: use: command not found
/tools/gnats/4.0/bin/stripmimed: line 49: use: command not found
/tools/gnats/4.0/bin/stripmimed: line 50: use: command not found
/tools/gnats/4.0/bin/stripmimed: line 51: use: command not found
/tools/gnats/4.0/bin/stripmimed: line 52: use: command not found
/tools/gnats/4.0/bin/stripmimed: line 54: undef: command not found
/tools/gnats/4.0/bin/stripmimed: line 56: my: command not found
/tools/gnats/4.0/bin/stripmimed: line 57: my: command not found
/tools/gnats/4.0/bin/stripmimed: line 58: my: command not found
/tools/gnats/4.0/bin/stripmimed: line 60: open: command not found
/tools/gnats/4.0/bin/stripmimed: line 61: or: command not found
/tools/gnats/4.0/bin/stripmimed: line 63: sub: command not found
/tools/gnats/4.0/bin/stripmimed: line 64: my: command not found
/tools/gnats/4.0/bin/stripmimed: line 66: print: command not found
/tools/gnats/4.0/bin/stripmimed: line 67: syntax error near unexpected token `}'
/tools/gnats/4.0/bin/stripmimed: line 67: `} # Log'
</pre></div>

<p>So how did we fix the shebang problem before? Also, why is queue-pr not properly updating the pr? (My suspicion is that the file attachment on this PR is messing up queue-pr - nope, that doesn't seem to be it...</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  6:35 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000493.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">December  7, 2005</h2>
                     <a id="a000492"></a>
                     <div class="entry" id="entry-492">
                        <h3 class="entry-header">BinMerge Module & Perl Issues</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Changed bin_merge to be a module so that it easier to call from UCMCustom</li>

  <li>Integrated new BinMerge.pm module into the UCMCustom</li>

  <li>Added fix to use "\" in get_vob_str</li>

  <li>Changed UCMCustom to use strict and warnings(we should always use these)</li>

  <li>Changed UCMCustom to use use instead of require</li>

  <li>Hunted down bug where UCMCustom undef's $/ (Bad UCMCustom!! Bad!)</lI>
</ul>
                              
                              <h2>BinMerge Module</h2>

<p>I decided to change bin_merge into a module (BinMerge) and use it in UCMCustom. I was having problems trying to start the bin_merge process and getting it going in a pipe so the output from verbose could give the user feed back. For some reason bin_merge has to exit before any output was returned. Might have been because of the $/ thing described below (Bad UCMCustom, bad!)</p>

<h2>Using strict</h2>

<p>I've been taught that both use strict and use warnings should always be used when coding Perl. These diagnoistic routines are helpful in catching some common Perl mistakes that are otherwise much more difficult to debug. In fact, in implementing this I found a few potential bugs that I also corrected.</p>

<blockquote>
<p><b>Note:</b> Some version of Perl do not have use warnings. Instead specify -w on the #! line.</p>
</blockquote>

<h2>Use vs Require</h2>

<p>Require is old hat. Use is the new require! From Perldoc's <a href="http://perldoc.perl.org/perlfaq8.html#What%27s-the-difference-between-require-and-use%3F">What's the difference between require and use?</a>:</p>

<blockquote>
  <h2>What's the difference between require and use?</h2>

  <p>Perl offers several different ways to include code from one file into another. Here are the deltas between the various inclusion constructs:</p>

  <ol>
    <li> do $file is like eval `cat $file`, except the former</li>
      <ol>
        <li>searches @INC and updates %INC.</li>

	<li>bequeaths an *unrelated* lexical scope on the eval'ed code.</li>
      </ol>

    <li>require $file is like do $file, except the former</li>
      <ol>
        <li>checks for redundant loading, skipping already loaded files.</li>

        <li>raises an exception on failure to find, compile, or execute $file.</li>
      </ol>

    <li>require Module is like require "Module.pm", except the former</li>
      <ol>
        <li>translates each "::" into your system's directory separator.</li>

        <li>primes the parser to disambiguate class Module as an indirect object.</li>
      </ol>

    <li>use Module is like require Module, except the former</li>
      <ol>
        <li>loads the module at compile time, not run-time.</li>

        <li>imports symbols and semantics from that package to the current one.</li>
      </ol>
  </ol>
</blockquote>

<p>Note that becuase use loads the module at compile time one need to arrange for the @INC array to have any paths needed for use to succeed (IOW user written modules). In order to accomplish this one need to seed the @INC arrray in a BEGIN block as BEGIN blocks are executed before use is expanded,</p>

<h2>$/ Bug</h2>

<p>From Perldoc's <a href="http://perldoc.perl.org/perlvar.html">Perlvar</a>:</p>

<blockquote>
  <p>You should be very careful when modifying the default values of most special variables described in this document. In most cases you want to localize these variables before changing them, since if you don't, the change may affect other modules which rely on the default values of the special variables that you have changed. This is one of the correct ways to read the whole file at once:</p>

  <div class="code"><pre>
  open my $fh, "foo" or die $!;
  local $/; # enable localized slurp mode
  my $content = <$fh>;
  close $fh;
  </pre></div>

  <p>But the following code is quite bad:</p>

  <div class="code"><pre>
  open my $fh, "foo" or die $!;
  undef $/; # enable slurp mode
  my $content = <$fh>;
  close $fh;
  </pre></div>

  <p>since some other module, may want to read data from some file in the default "line mode", so if the code we have just presented has been executed, the global value of $/ is now changed for any other code running inside the same Perl interpreter.</p>
</blockquote>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:44 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000492.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">December  6, 2005</h2>
                     <a id="a000491"></a>
                     <div class="entry" id="entry-491">
                        <h3 class="entry-header">Stripmime/Cleardiffmrg/CharacterSetValidation</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Fixed stripmime</li>

  <li>Worked with Shivdutt regarding the cleardiffmrg problem. Turns out to be a leading "/". Shivdutt fixed UCMCustom.pl</lI>

  <li>Turned off character set validation on p4test for PQA. Have not implemented this on production yet</li>
</ul>
                              
                              <h2>Stripmime</h2>

<p>After banging my head against stripmime all day I finally figured it out. It would work from the command line but not from sendmail! It turned out to be the fact that I was not setting output_dir rather deferring to cwd and in the context of sendmail and aliases I guess that won't do. Changed stripmime to call $parser->output_dir ("/tmp"). Ravi needs to test this then we can implement.</p>

<h2>Cleardiffmrg</h2>

<p>Tommy Kee was having problems with merging where the cleardiffmrg tool would not come up stating instead that it encountered and error. I had seen this sort of error before at Ameriquest but it was specifically with snapshot views and with views that were tagged with forward slashes (something that mktag allows but cleardiffmrg has a problem with). But here we were dealing with dynamic views and the view tags were with all backslashes (\).</p>

<p>However, UCMCustom.pl would call cleartool findmerge with a leading forward slash (e.g. /andy\path\to\search). I suspected that this leading slash might be causing the problem and eventual showed that it was indeed the problem. Shivdutt changed UCMCustom.pl to use a leading blackslash.</p>

<h2>CharacterSetValidation</h2>

<p>I called IBM/Rational support this morning to raise the priority on this one. The priority has been raised and IBM/Rational is investigating this more fully. Meantime they suggested, as a temporary workaround, to turn off checking of code pages. I've tried this:</p>

<div class="code"><pre>
    $ installutil setdbcodepagetonochecking -dbset 2005.02.00 admin <password>
    *********************************************************
    Starting test setdbcodepagetonochecking
    *********************************************************
    Note: setting the code page to 'no checking' can result
    in data corruption. Please refer to the ClearQuest Release
    Notes for more information.
    Successfully set the code page to 'no checking'.

    *********************************************************
    Exit code 0 for test setdbcodepagetonochecking
    *********************************************************
</pre></div>

<p>Note that this does not stop the CharacterSetValidation package from complaining! Turning off the CharacterSetValidation requires a schema change to return FALSE from enable_char_set_validation.</p>

                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  5:20 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000491.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                     

                     <h2 class="date-header">December  5, 2005</h2>
                     <a id="a000489"></a>
                     <div class="entry" id="entry-489">
                        <h3 class="entry-header">Cleardiffmrg/bin_merge problems</h3>
                        <div class="entry-content">
                           <div class="entry-body">
                              <ul>
  <li>Told Andrew about new -reuse_stream option to create_dev_snapview.pl. I have him testing this</li>

  <li>Worked with Shivdutt and IBM/Rational on problem with cleardiffmrg. I think I've worked this out to the leading "/" that UCMCustom users.</li>

  <li>Finished stripmime - Ray testing it - created stripmimed that logs to /tmp.</li>

  <li>Worked at getting bin_merge integrated into UCMCustom.pl</li>

  <li>Implemented quick script (topper) to try to catch the hanging problem with ccase-rmna-3</li>
</ul>
                              
                              <h2>Cleardiffmgr problem</h2>

<p>The problem occurs during a deliver between projects where there is a merge conflict and UCMCustom wants to have findmerge call up a Cleardiffmgr to resolve the conflicts. I've seen this before WRT snapshot views and view tags with forward slashes at Ameriquest. UCMCustom perfaces' the vob tags with "/".</p>

<p>But this problem doesn't always happen - in fact most of the time it appears to work. It might be just when there's a merge conflict</p>

<p>After working with Shivdutt and IBM/Rational on the problem and getting down to reproducing it with a long cleartool findmerge command in the user's environment this problem started happening to me in my test environment as I was integrating bin_merge. After much narrowing down I found:</p>

<p>Here's some more information. As you know I started having a similar problem as the end user. I paired it down to the following. This fails (but does not always fail):</p>

<div class="code"><pre>
    Z:\andys_pvob>cleartool findmerge /andy\bin\cygwin_setup -fver \main\Andrew_Integration\6 -log NUL -gmerge -nc
    Needs Merge "/andy\bin\cygwin_setup" [to \main\Andrew_Integration\Andrew2_Integration\CHECKEDOUT from \main\Andrew_Integration\6 base \main\Andrew_Integration\5]
</pre></div>

<p>However the following does work:</p>

<div class="code"><pre>
    Z:\andys_pvob>cleartool findmerge \andy\bin\cygwin_setup -fver \main\Andrew_Integration\6 -log NUL -gmerge -nc
    Needs Merge "\andy\bin\cygwin_setup" [to \main\Andrew_Integration\Andrew2_Integration\CHECKEDOUT from \main\Andrew_Integration\6 base \main\Andrew_Integration\5]
</pre></div>

<p>Notice the difference? It's subtle. The first findmerge's path starts with a "/" while the second one starts with a "\".</p>

<h2>bin_merge integration</h2>

<p>My bin_merge script remains it's own process. This will be useful if others wish to use this process. However UCMCustom needs to incorporate calling bin_merge. I'm currently having a problem with this because I want to start bin_merge as a pipe so I can give the user feedback. But bin_merge runs to completion before the first output is received. I don't know why this is happening as it doesn't happen in a smaller test.pl environment, only under the massive UCMCustom.pl...</p>
                              
                              <p class="entry-footer">
                                 <span class="post-footers">Posted by  at  7:54 PM</span> <span class="separator">|</span> <a class="permalink" href="http://defaria.com/blogs/Status/archives/000489.html">Permalink</a>
                                 
                                 
                              </p>
                           </div>
                        </div>
                     </div>
                     
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
</html>
